{"pages":[{"title":"categories","text":"","link":"/categories/index.html"}],"posts":[{"title":"æ‹¾é—JavaScriptâ€”â€”async-await","text":"async/await async/await åŒ Promiseã€callback ä¸€æ ·æ˜¯ä¸€ç§ç¼–å†™å¼‚æ­¥ä»£ç çš„æ–¹æ³•ã€‚ async/await å®é™…ä¸Šæ˜¯å»ºç«‹åœ¨ promises ä¹‹ä¸Šçš„ï¼Œå…¶è¿”å›çš„æ˜¯ä¸€ä¸ª promiseã€‚ async/await æ˜¯éé˜»å¡çš„ã€‚ async/await æ›´åƒæ˜¯åŒæ­¥ä»£ç ï¼Œå¦‚æœå¤šä¸ªå¼‚æ­¥ä»£ç æ²¡æœ‰ä¾èµ–æ€§å´ä½¿ç”¨äº† await ä¼šå¯¼è‡´æ€§èƒ½ä¸Šçš„é™ä½ã€‚ æè¿°å½“è°ƒç”¨ä¸€ä¸ª async å‡½æ•°æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å½“è¿™ä¸ª async å‡½æ•°è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼ŒPromise çš„ resolve æ–¹æ³•ä¼šè´Ÿè´£ä¼ é€’è¿™ä¸ªå€¼ï¼›å½“ async å‡½æ•°æŠ›å‡ºå¼‚å¸¸æ—¶ï¼ŒPromise çš„ reject æ–¹æ³•ä¹Ÿä¼šä¼ é€’è¿™ä¸ªå¼‚å¸¸å€¼ã€‚ async å‡½æ•°ä¸­å¯èƒ½ä¼šæœ‰ await è¡¨è¾¾å¼ï¼Œè¿™ä¼šä½¿ async å‡½æ•°æš‚åœæ‰§è¡Œï¼Œç­‰å¾… Promise çš„ç»“æœå‡ºæ¥ï¼Œç„¶åæ¢å¤ async å‡½æ•°çš„æ‰§è¡Œå¹¶è¿”å›è§£æå€¼ï¼ˆresolvedï¼‰ã€‚ æ³¨æ„ï¼Œ await å…³é”®å­—ä»…ä»…åœ¨ async functionä¸­æœ‰æ•ˆã€‚å¦‚æœåœ¨ async functionå‡½æ•°ä½“å¤–ä½¿ç”¨ await ï¼Œä½ åªä¼šå¾—åˆ°ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼ˆSyntaxErrorï¼‰ã€‚ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function ğŸŒ°å‡è®¾ä¸€ä¸ªå‡½æ•°getJsonData() æ¥è·å– Json æ•°æ®ã€‚ promise 12345const request = url =&gt; &#123; getJsonData(url).then(response =&gt; &#123; console.log(response.data); &#125;);&#125;; async/await 123const request = async url =&gt; &#123; console.log(await getJsonData(url));&#125;; çœ‹è¿™æ ·çœ‹èµ·æ¥ï¼Œasync/await æ˜¯ä¸æ˜¯ç®€æ´äº†å¾ˆå¤šï¼Ÿ æ¯•ç«Ÿå†™ä¸€å † then ä¹Ÿæ˜¯å¾ˆçƒ¦çš„ã€‚ é”™è¯¯å¤„ç† (try/catch)1code snippet async/await hellasync/await æŠŠæˆ‘ä»¬ä»æ›¾ç»çš„callback hell ä¸­è§£æ”¾ï¼Œè€Œç°åœ¨ï¼Œæˆ‘ä»¬é™·å…¥äº†async/await hellã€‚","link":"/2019/03/12/æ‹¾é—JavaScriptâ€”â€”async-await/"},{"title":"æ‹¾é—JavaScriptâ€”â€”var-let-const","text":"å˜é‡çš„å£°æ˜æ–¹å¼varå£°æ˜å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ã€‚ letå£°æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ã€‚ constå£°æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„åªè¯»å¸¸é‡(éœ€è¦åˆå§‹å€¼)ã€‚ å˜é‡æå‡12console.log(a);var a = 1; // undefined å®é™…ä¸Šä¸Šéƒ¨åˆ†çš„ä»£ç å¯ä»¥ç†è§£ä¸º: 123var a;console.log(a);a = 1; è¿™å°±æ˜¯å˜é‡æå‡ã€‚ å¯¹äºå‡½æ•°æ¥è¯´ï¼Œåªæœ‰å‡½æ•°å£°æ˜ä¼šè¢«æå‡åˆ°é¡¶éƒ¨ï¼Œè€Œå‡½æ•°è¡¨è¾¾å¼ä¸ä¼šè¢«æå‡ã€‚ 12345baz(); // baz is not a functionvar baz = function() &#123; console.log(\"bar2\");&#125;; æš‚æ—¶æ€§æ­»åŒºletï¼ˆconstï¼‰å°†ä¸ä¼šæå‡å˜é‡åˆ°ä»£ç å—çš„é¡¶éƒ¨ã€‚å› æ­¤ï¼Œåœ¨å˜é‡å£°æ˜ä¹‹å‰å¼•ç”¨è¿™ä¸ªå˜é‡ï¼Œå°†æŠ›å‡ºå¼•ç”¨é”™è¯¯ï¼ˆReferenceErrorï¼‰ã€‚è¿™ä¸ªå˜é‡å°†ä»ä»£ç å—ä¸€å¼€å§‹çš„æ—¶å€™å°±å¤„åœ¨ä¸€ä¸ªâ€œæš‚æ—¶æ€§æ­»åŒºâ€ï¼Œç›´åˆ°è¿™ä¸ªå˜é‡è¢«å£°æ˜ä¸ºæ­¢ã€‚ 12console.log(a);let a = 1; //a is not defined","link":"/2019/03/27/æ‹¾é—JavaScriptâ€”â€”var-let-const/"},{"title":"æ‹¾é—JavaScriptâ€”â€”this","text":"thisthis åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ç¡®å®š this çš„æŒ‡å‘æ€§ï¼Ÿ this æ˜¯è®©äººå›°æƒ‘çš„ä¸œè¥¿ï½ this åœ¨æ¯ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸä¸­è¢«è‡ªåŠ¨åˆ›å»ºï¼Œå½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡(execution context) è¢«åˆ›å»º æ‰§è¡Œä¸Šä¸‹æ–‡ ä¸­åŒ…å«ä¸€ä¸‹ä¿¡æ¯ å‡½æ•°åœ¨å“ªè°ƒç”¨ï¼ˆcall-stackï¼‰ å‡½æ•°æ€ä¹ˆè¢«è°ƒç”¨ ä½œç”¨åŸŸé“¾ å¯¹è±¡å‚æ•° this â€¦ thisï¼ŒæŒ‡å‘å‡½æ•°æ‰§è¡ŒæœŸé—´çš„thiså¯¹è±¡ã€‚ 1ã€thisä¸æ˜¯åˆ›å»ºæ—¶ç»‘å®šï¼Œè€Œæ˜¯åŠ¨æ€ç»‘å®šï¼ˆruntime bindingï¼‰ 2ã€ thisçš„ä¸Šä¸‹æ–‡åŸºäºå‡½æ•°çš„è°ƒç”¨æƒ…å†µï¼Œå’Œå‡½æ•°åœ¨å“ªå®šä¹‰æ²¡æœ‰å…³ç³»ã€‚ è°ƒç”¨æƒ…å†µåˆ†æ1.å…¨å±€ä½œç”¨åŸŸï¼ˆglobal contextï¼‰1.1 æµè§ˆå™¨ä¸­ï¼ŒthisæŒ‡å‘windowindex.js1console.log(this) // window; 1.2 åœ¨nodejsä¸­ï¼ŒthisæŒ‡å‘ globalindex.js1console.log(this) // global; 2.å‡½æ•°ä½œç”¨åŸŸåœ¨å‡½æ•°å†…éƒ¨ï¼Œthisç”±å‡½æ•°å¦‚ä½•è°ƒç”¨æ¥ç¡®å®šæŒ‡å‘ 2.1 ä½œä¸ºå‡½æ•°è°ƒç”¨ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œthiså¹¶æ²¡æœ‰é€šè¿‡callæŒ‡å®šï¼Œä½†thiså¿…é¡»æŒ‡å®šå¯¹è±¡ï¼Œå› æ­¤é»˜è®¤æŒ‡å‘windowï¼Œæ‰€ä»¥è°ƒç”¨foo()è¾“å‡º1ã€‚index.js12345function foo() &#123; return this.a;&#125;var a = 1;console.log(foo()); // 1 åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œthisä¼šä¿æŒåœ¨è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶æ‰€è®¾ç½®çš„æŒ‡å‘ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œé»˜è®¤æŒ‡å‘undefinedã€‚ index.js12345678910111213function fn() &#123; 'use strict' return this;&#125;console.log(fn()); //undefinedfunction foo() &#123; 'use strict' return this.a;&#125;var a = 1;console.log(foo()); // TypeError: Cannot read property 'a' of undefined 2.2 å¯¹è±¡æ–¹æ³•è°ƒç”¨å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘è¯¥å¯¹è±¡ã€‚ index.js1234567const animal = &#123; name: \"animal\", sayName: function() &#123; console.log(this.name); &#125;&#125;;animal.sayName(); // animal åŸå‹é“¾ä¸Šçš„æ–¹æ³•è°ƒç”¨ä¸å¯¹è±¡æ–¹æ³•è°ƒç”¨ä¸€æ ·ï¼ŒthisæŒ‡å‘å¯¹è±¡æ–¹æ³•è°ƒç”¨æ—¶çš„å¯¹è±¡ã€‚ index.js12345678910function Person(name, age) &#123; this.name = name; this.age = age; &#125;Person.prototype.getName = function() &#123; return this.name;&#125;var p1 = new Person(â€˜Kenâ€™, 20);p1.getName(); // Ken ä¸‹é¢è®²new è°ƒç”¨æ„é€ å‡½æ•°æ‰€å‘ç”Ÿçš„äº‹ã€‚ 2.3 æ„é€ å‡½æ•°è°ƒç”¨æ„é€ å‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘å½“å‰å®ä¾‹å¯¹è±¡ã€‚ index.js1const a = new foo(); // thisæŒ‡å‘a; newè°ƒç”¨æ„é€ å‡½æ•°ï¼š 1ã€åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ 2ã€å°†æ–°å¯¹è±¡çš„åŸå‹è®¾ç½®ä¸ºæ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡prototype 3ã€æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå°†thisæŒ‡å‘æ–°å¯¹è±¡ 4ã€è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ æ¨¡æ‹Ÿå®ç°ï¼š new.js123456789101112131415161718192021222324function create() &#123; let obj = new Object(); //ä»Object.prototypeä¸Šå…‹éš†ä¸€ä¸ªå¯¹è±¡ //let obj = &#123;&#125;; let Constructor = [].shift.call(arguments); //è·å–ä¼ å…¥çš„æ„é€ å‡½æ•° obj.proto = Constructor.prototype; // å°†æ–°å¯¹è±¡çš„protoæŒ‡å‘æ„é€ å‡½æ•°çš„prototype let result = Constructor.apply(obj, arguments); // å°†thisæŒ‡å‘æ–°å¯¹è±¡,å¹¶æ‰§è¡Œæ„é€ å‡½æ•° return result instanceof Object ? result : obj; // ç¡®ä¿è¿”å›çš„æ˜¯å¯¹è±¡&#125;function animal(name, fit) &#123; this.name = name; this.fit = fit;&#125;animal.prototype.sayName = function() &#123; console.log(this.name);&#125;;const pig = create(animal, â€œKenâ€, 12);pig.sayName(); // Ken 2.4 applyã€callã€bind2.4.1 applyã€callcallï¼š ä½¿ç”¨ä¸€ä¸ªæŒ‡å®šçš„thiså’Œè‹¥å¹²æŒ‡å®šå‚æ•°çš„å‰æä¸‹ï¼Œè°ƒç”¨æŸä¸ªå‡½æ•°æˆ–æ–¹æ³•ã€‚applyï¼š ä¸callç±»ä¼¼ï¼Œåªæ˜¯æä¾›å‚æ•°çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œapplyçš„å‚æ•°æ˜¯æ•°ç»„ã€‚ 12345678910function sum(c, d) &#123; return this.a + this.b + c + d;&#125;const obj = &#123; a: 1, b: 2&#125;;console.log(sum.call(obj, 1, 2)); // 6console.log(sum.apply(obj, [3, 4])); // 10 2.4.2 bind bindï¼š æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œåœ¨bind()è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„thisè¢«bindçš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šï¼Œå…¶ä½™çš„å‚æ•°å°†ä½œä¸ºæ–°å‡½æ•°çš„å‚æ•°ä¾›è°ƒç”¨æ—¶ä½¿ç”¨ã€‚ MDN: https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind ä¸apply,call ä¸åŒçš„æ˜¯ï¼Œbind è¿”å›ä¸€ä¸ªåŸå‡½æ•°çš„æ‹·è´ã€‚ 123456789101112var a = 10;const module = &#123; a:1, getA:function() &#123; return this.a; &#125;&#125;module.getA(); // 1; å¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼Œ`this`æŒ‡å‘moduleconst getValueA = module.getA;getValueA(); // 10 å…¨å±€ä½œç”¨åŸŸä¸­è°ƒç”¨getA()ï¼Œæ‰€ä»¥è¿™é‡Œè¾“å‡º10.const fn = getValueA.bind(module); //æŠŠ 'this' ç»‘å®šåˆ° module å¯¹è±¡fn(); // 1 å¦‚æœå°†null/undefinedä½œä¸ºthisä¼ å…¥ï¼Œåœ¨è¢«è°ƒç”¨çš„æ—¶å€™ä¼šè¢«å¿½ç•¥ï¼Œä½¿ç”¨é»˜è®¤ç»‘å®šï¼ˆwindowï¼‰ã€‚å¯ä»¥ä¼ {}è®©thisä¸ºç©ºã€‚ æ— è®ºbind()å¤šå°‘æ¬¡ï¼Œthisçš„æŒ‡å‘æ°¸è¿œç”±ç¬¬ä¸€å†³å®šã€‚ 2.5 ç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°çš„thisç»§æ‰¿äºåŒ…è£¹å®ƒçš„ç¬¬ä¸€ä¸ªæ™®é€šå‡½æ•°çš„thisï¼Œå¦‚æœæ²¡æœ‰æ™®é€šå‡½æ•°ï¼Œåˆ™ä¸ºå…¨å±€å¯¹è±¡ã€‚ ç®­å¤´å‡½æ•°çš„thisåœ¨ç¬¬ä¸€æ¬¡ç»‘å®šåå°±ä¸ä¼šå†æ”¹å˜ã€‚ ä¸èƒ½ä½¿ç”¨newæ¥è°ƒç”¨ 1234567891011121314151617181920212223242526function fn() &#123; return () =&gt; &#123; return () =&gt; &#123; console.log(this) &#125; &#125;&#125;console.log(fn()()()) // Windowvar name = \"Ken\"const module = &#123; name: \"module\", getName: function() &#123; const fn = ()=&gt; &#123; console.log(this.name) &#125; fn(); &#125;, // å¤–å±‚æ²¡æœ‰æ™®é€šå‡½æ•°åŒ…è£¹ï¼Œå› æ­¤`this`æŒ‡å‘å…¨å±€ä½œç”¨åŸŸ arrowFn: ()=&gt; &#123; console.log(this.name) &#125;&#125;module.getName(); // modulemodule.arrowFn(); // ken æ€»ç»“thisçš„ç»‘å®šè§„åˆ™å¯ä»¥åˆ†ä¸º newç»‘å®š æ˜¾ç¤ºç»‘å®šï¼šcallã€applyã€bind éšå¼ç»‘å®šï¼šä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨ é»˜è®¤ç»‘å®šï¼šå‡½æ•°è°ƒç”¨ ä¼˜å…ˆçº§ï¼šnew &gt; callã€applyã€bind &gt; obj.fn() &gt; fn()","link":"/2019/03/22/æ‹¾é—JavaScriptâ€”â€”this/"},{"title":"æ‹¾é—JavaScriptâ€”â€”æ·±ã€æµ…æ‹·è´","text":"æ•°æ®ç±»å‹JavaScript ä¸­å˜é‡çš„æ•°æ®ç±»å‹åˆ†ä¸¤ç§ï¼š åŸºæœ¬ç±»å‹ ï¼ˆå­˜å‚¨ä¸æ ˆå†…å­˜ä¸­ï¼Œå€¼å­˜å‚¨ï¼‰ å¼•ç”¨ç±»å‹ ï¼ˆå­˜å‚¨å †å†…å­˜ä¸­ï¼Œé€šè¿‡æŒ‡é’ˆå»å¯»æ‰¾æ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼‰ å¯¹äºå€¼ç±»å‹çš„å¤åˆ¶æ“ä½œæ˜¯ç›´æ¥å †å˜é‡çš„å€¼è¿›è¡Œæ‹·è´ï¼›å¯¹äºå¼•ç”¨ç±»å‹çš„å¤åˆ¶æ“ä½œæ˜¯å¯¹å­˜å‚¨å˜é‡çš„æŒ‡é’ˆè¿›è¡Œæ‹·è´ï¼ŒæŒ‡å‘åŒä¸€å†…å­˜ç©ºé—´ï¼Œä¿®æ”¹å…¶ä¸­ä¸€ä¸ªä¼šå½±å“å¦ä¸€æ–¹ã€‚ æ·±æµ…æ‹·è´åªé’ˆå¯¹äº Arrayã€Object è¿™æ ·å¤æ‚çš„å¯¹è±¡ æµ…æ‹·è´åªæ‹·è´åŸºæœ¬ç±»å‹çš„æ•°æ®ï¼Œå¯¹äºå¼•ç”¨çš„ç±»å‹æ•°æ®ï¼Œå¤åˆ¶åä¹Ÿæ˜¯ä¼šå‘ç”Ÿå¼•ç”¨ï¼Œè¿™ç§æ‹·è´å°±å«åšæµ…æ‹·è´ ğŸŒ°ï¼š å¯¹äºå¯¹è±¡æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡Object.assign()ã€...æ¥å®ç°æµ…æ‹·è´1ã€Object.assign()1234567let obj = &#123; name: \"ken\"&#125;;let newObj = Object.assign(&#123;&#125;, obj);obj.name = \"obi\";console.log(obj.name); // name:obiconsole.log(newObj.name); // name: ken 2ã€...å±•å¼€è¿ç®—ç¬¦123456789let obj = &#123; name: \"ken\"&#125;;let newObj = &#123; ...obj&#125;;obj.name = \"obi\";console.log(obj.name); // name:obiconsole.log(newObj.name); // name: ken ğŸŒ°ï¼šå¯¹äºæ•°ç»„ï¼Œå¯ä»¥é€šè¿‡concat()ã€slice() æ¥å®ç°æµ…æ‹·è´1ã€concat()concat() æ–¹æ³•ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ã€‚æ­¤æ–¹æ³•ä¸ä¼šæ›´æ”¹ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚concat æ–¹æ³•ä¸ä¼šæ”¹å˜ this æˆ–ä»»ä½•ä½œä¸ºå‚æ•°æä¾›çš„æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæµ…æ‹·è´ï¼Œå®ƒåŒ…å«ä¸åŸå§‹æ•°ç»„ç›¸ç»“åˆçš„ç›¸åŒå…ƒç´ çš„å‰¯æœ¬ã€‚ åŸå§‹æ•°ç»„çš„å…ƒç´ å°†å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­ã€‚ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/concat 12345let arr = [1, 2, 3];let newArr = arr.concat();arr.push(4);console.log(arr); //[1,2,3,4]console.log(newArr); //[1,2,3] 2ã€slice()slice() æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œè¿™ä¸€å¯¹è±¡æ˜¯ä¸€ä¸ªç”± begin å’Œ endï¼ˆä¸åŒ…æ‹¬ endï¼‰å†³å®šçš„åŸæ•°ç»„çš„æµ…æ‹·è´ã€‚åŸå§‹æ•°ç»„ä¸ä¼šè¢«æ”¹å˜ã€‚ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/slice 12345let arr = [1, 2, 3];let newArr = arr.slice();arr.push(4);console.log(arr); //[1,2,3,4]console.log(newArr); //[1,2,3] å½“é¢å¯¹å¤æ‚ä¸€ç‚¹çš„å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œä½¿ç”¨ Object.assign(),Array.slice() ä¼šæ€ä¹ˆæ ·ï¼Ÿä¾‹å¦‚:1234567891011121314let obj = &#123; a: 1, b: 2, c: &#123; d: 1, e: 2 &#125;&#125;;let newObj = Object.assign(&#123;&#125;, obj);obj.a = 2;newObj.c.d = 2;console.log(obj); // &#123;a:2,b:2,c:&#123;d:2,e:2&#125;&#125;console.log(newObj); // &#123;a:1,b:2,c:&#123;d:2,e:2&#125;&#125; 12345678let arr = [1, 2, [1, 2], 3];let newArr = arr.concat();arr.push(4);arr[2].push(3);console.log(arr); //[1,2,[1,2,3],3,4]console.log(newArr); //[1,2,[1,2,3],3] ä»£ç é‡Œä¿®æ”¹äº†obj.açš„å€¼ï¼Œå¹¶æ²¡å¯¹newObjé€ æˆå½±å“ï¼Œè€Œä¿®æ”¹äº†newObj.c.dçš„å€¼ï¼Œobj.c.dçš„å€¼ä¹Ÿéšç€æ”¹å˜ã€‚è¿™æ˜¯å› ä¸ºObject.assign()æ˜¯æµ…æ‹·è´ï¼Œåªæ‹·è´äº†ä¸€å±‚ï¼Œå¯¹äºobj.cæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥newObj.cå­˜å‚¨çš„æ˜¯æŒ‡å‘obj.cæ‰€æŒ‡å‘çš„æŒ‡é’ˆåœ°å€ã€‚åŒç†...å±•å¼€è¿ç®—ç¬¦ã€Array.concat()/Array.slice() æ·±æ‹·è´è§£å†³ä¸Šè¿°é—®é¢˜æœ€å¸¸è§çš„å®ç°æ–¹å¼å°±æ˜¯ï¼šJSON.parse(JSON.stringify(object)) 123456789101112131415let obj = &#123; a: 1, b: 2, c: &#123; d: 1, e: 2 &#125;&#125;;let newObj = JSON.parse(JSON.stringify(obj));obj.a = 2;newObj.c.d = 2;console.log(obj); //&#123;a:2,b:2,c:&#123;d:1,e:2&#125;&#125;console.log(newObj); //&#123;a:1,b:2,c:&#123;d:2,e:2&#125;&#125; å½“ç„¶ï¼Œå¯¹è±¡çš„åºåˆ—åŒ–ååºåˆ—åŒ–JSON.parse(JSON.stringify())å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚ å¿½ç•¥ undefined å¿½ç•¥ symbol ä¸èƒ½åºåˆ—åŒ–å‡½æ•° ä¸èƒ½è§£å†³å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify 12345678910111213141516171819202122232425let obj = &#123; a: () =&gt; &#123; console.log(\"copy\"); &#125;, b: undefined, c: Symbol, d: \"obi\"&#125;;let newObj = JSON.parse(JSON.stringify(obj));console.log(newObj); // &#123;d:obi&#125; å¿½ç•¥undefinedã€symbolã€ä¸èƒ½åºåˆ—åŒ–åŒ–å‡½æ•°let obj = &#123; a: 1, b: &#123; c: 2 &#125;&#125;;obj.c = obj.b; // `obj.c` å¼•ç”¨ `obj.b`obj.b.c = obj.c; // `obj.b.c` åˆå¼•ç”¨ `obj.c`let newObj = JSON.parse(JSON.stringify(obj));console.log(newObj); // ç›´æ¥æŠ¥é”™ å®ç°ç®€æ˜“çš„æµ…æ‹·è´ã€æ·±æ‹·è´æµ…æ‹·è´1234567891011121314151617181920const fn = (data, target = &#123;&#125;) =&gt; &#123; for (let item in data) &#123; if (data.hasOwnProperty(item)) &#123; target[item] = data[item]; &#125; &#125; return target;&#125;;let obj = &#123; a: 1, b: 2&#125;;let newObj = fn(obj);obj.a = 2;console.log(obj); //&#123;a:2,b:2&#125;console.log(newObj); //&#123;a:1,b:2&#125; æµ…æ‹·è´å°±æ˜¯ä¸€ä¸ªfor..inå¾ªç¯,Object.prototype.hasOwnPropertyçš„ä½œç”¨æ˜¯æ£€æµ‹ç›®æ ‡æ˜¯å¦å±äºè‡ªæœ‰å±æ€§,æ˜¯åˆ™å¤åˆ¶ æ·±æ‹·è´123456789101112131415161718192021222324252627282930const isObj = o =&gt; &#123; return typeof o === \"object\" || (typeof o === \"function\" &amp;&amp; o !== null);&#125;;const deepClone = obj =&gt; &#123; if (!isObj(obj)) &#123; throw new Error(\"not a Objectï¼\"); &#125; let newObj = Array.isArray(obj) ? [] : &#123;&#125;; // åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„æˆ–è€…æ˜¯å¯¹è±¡,è®¾ç½®åˆå§‹å€¼ä¸ºç©ºå€¼ Object.keys(obj).forEach(key =&gt; &#123; newObj[key] = isObj(obj[key]) ? deepClone(obj[key]) : obj[key]; &#125;); return newObj;&#125;;let obj = &#123; a: [1, 2, 3], b: &#123; c: 2, d: 3 &#125;&#125;;let newObj = deepClone(obj);newObj.b.c = 1;console.log(obj.b.c); // 2console.log(newObj.b.c); // 1 è¿™åªæ˜¯ç®€å•çš„æ·±æ‹·è´ï¼Œæœªè€ƒè™‘å…¶ä»–æƒ…å†µï¼Œå…¶ä½™å¦åšæ¢ç©¶ã€‚ å‚è€ƒæ¥è‡ª Googleã€MDN","link":"/2019/03/05/æ‹¾é—JavaScriptâ€”â€”æ·±ã€æµ…æ‹·è´/"},{"title":"Javascriptâ€”â€”é˜²æŠ–ä¸èŠ‚æµ","text":"é˜²æŠ–é˜²æ­¢å‡½æ•°å¤šæ¬¡è°ƒç”¨ï¼Œä¾‹å¦‚ä¸€ä¸ªç”¨æˆ·ä¸€ç›´è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œä¸”æ¯æ¬¡è§¦å‘å‡½æ•°çš„é—´éš”å°äº waitï¼Œé˜²æŠ–çš„æƒ…å†µä¸‹åªä¼šè°ƒç”¨ä¸€æ¬¡ã€‚ Code1234567891011121314151617181920212223242526/\\*\\*- é˜²æŠ–å‡½æ•°- @param &#123;function&#125; fn éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œï¼ˆä¾‹å¦‚ç½‘ç»œè¯·æ±‚ï¼‰- @param &#123;number&#125; wait ç­‰å¾…æ—¶é—´ï¼Œé¢„è®¾ 50ms- @returns &#123;function&#125; éœ€è¦è¿›è¡Œé˜²æŠ–å¤„ç†çš„å‡½æ•° \\*/ const debounce = (fn, wait = 50) =&gt; &#123; let timer = 0; //åˆå§‹åŒ–ä¸€ä¸ªå®šæ—¶å™¨ // è¿”å›è¿›è¡Œé˜²æŠ–å¤„ç†çš„å‡½æ•° return function(...arguments) &#123; // å¦‚æœå®šæ—¶å™¨å­˜åœ¨åˆ™æ¸…ç©ºä¸Šä¸€æ¬¡çš„å®šæ—¶å™¨ if (timer) &#123; clearTimeout(timer); &#125; // é‡æ–°è®¡æ—¶ï¼Œå»¶è¿Ÿæ‰§è¡Œä¼ å…¥çš„å‡½æ•° timer = setTimeout(() =&gt; &#123; fn.apply(this, arguments); &#125;, wait); &#125;; &#125;; // Button æŒ‰é’® document.getElementById('btn').addEventListener('click',debounce(function(e) &#123; console.log(\"change\", e.target.value, new Date() - 0); &#125;, 350)) ä¸€èˆ¬é˜²æŠ–éƒ½ä¼šæœ‰ä¸€ä¸ªé€‰é¡¹ï¼šæ˜¯å¦ç«‹å³è°ƒç”¨ã€‚åœ¨ä¸åŒä½¿ç”¨åœºæ™¯è¿›è¡ŒåŒºåˆ†ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š åœ¨æœç´¢å¼•æ“æœç´¢é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“ç„¶æ˜¯å¸Œæœ›ç”¨æˆ·è¾“å…¥å®Œæœ€åä¸€ä¸ªå­—æ‰è°ƒç”¨æŸ¥è¯¢æ¥å£ï¼Œè¿™ä¸ªæ—¶å€™é€‚ç”¨å»¶è¿Ÿæ‰§è¡Œçš„é˜²æŠ–å‡½æ•°ï¼Œå®ƒæ€»æ˜¯åœ¨ä¸€è¿ä¸²ï¼ˆé—´éš”å°äº wait çš„ï¼‰å‡½æ•°è§¦å‘ä¹‹åè°ƒç”¨ã€‚ æ–‡æœ¬è¾“å…¥çš„éªŒè¯ï¼ˆè¿ç»­è¾“å…¥æ–‡å­—åå‘é€è¯·æ±‚è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯ä¸€æ¬¡å°±å¥½)ã€‚ æ¯”å¦‚ä¸€ä¸ª start æŒ‰é’®ï¼Œå½“ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ç«‹åˆ»æ”¹å˜æŒ‰é’®å½¢çŠ¶ï¼Œè¿™æ—¶å€™ç”¨æˆ·å¯ä»¥çŸ¥é“äº¤äº’æ“ä½œæ­£åœ¨è¿›è¡Œï¼Œé‚£ä¹ˆéœ€è¦ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚ æ”¹é€ ï¼šåŠ å…¥ç«‹å³æ‰§è¡Œé€‰é¡¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// è·å–å½“æ—¶é—´const getNowDate = () =&gt; &#123;&#125;;/\\*\\*- é˜²æŠ–- @param &#123;function&#125; fn éœ€è¦æ‰§è¡Œçš„å‡½æ•°ï¼Œï¼ˆä¾‹å¦‚ç½‘ç»œè¯·æ±‚ï¼‰- @param &#123;Boolean&#125; immediate æ˜¯å¦ç«‹å³æ‰§è¡Œï¼Œé»˜è®¤ true- @param &#123;Number&#125; wait ç­‰å¾…æ—¶é—´ï¼Œé¢„è®¾ 50ms- @returns &#123;function&#125; éœ€è¦è¿›è¡Œé˜²æŠ–å¤„ç†çš„å‡½æ•° \\*/ const debounce = (fn, immediate = true, wait = 50) =&gt; &#123; let timer = 0; //åˆå§‹åŒ–ä¸€ä¸ªå®šæ—¶å™¨ let context, args; //æ‰§è¡Œä¸Šä¸‹æ–‡ã€å‚æ•° // å»¶è¿Ÿæ‰§è¡Œå‡½æ•° const later = () =&gt; setTimeout(() =&gt; &#123; // å»¶è¿Ÿå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œæ¸…ç©ºç¼“å­˜çš„å®šæ—¶å™¨ timer = null; if (!immediate) &#123; // æ‰§è¡Œå‡½æ•° fn.apply(context, args); // é‡ç½®æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‚æ•° context = args = null; &#125; &#125;, wait);// è¿”å›è¿›è¡Œé˜²æŠ–å¤„ç†çš„å‡½æ•°return function(...arguments) &#123;// å¦‚æœå®šæ—¶å™¨ä¸å­˜åœ¨åˆ™åˆ›å»ºå»¶è¿Ÿå®šæ—¶å™¨ã€‚if (!timer) &#123;timer = later();// å¦‚æœæ˜¯ç«‹å³æ‰§è¡Œï¼Œåˆ™æ‰§è¡Œå‡½æ•°if (immediate) &#123;fn.apply(this, arguments);&#125; else &#123;//ç¼“å­˜æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå‚æ•°context = this;args = arguments;&#125;&#125; else &#123;// å¦‚æœå·²æœ‰å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼ˆlaterï¼‰ï¼Œè°ƒç”¨çš„æ—¶å€™æ¸…é™¤åŸæ¥çš„å¹¶é‡æ–°è®¾å®šä¸€ä¸ª.// è¿™æ ·åšå»¶è¿Ÿå‡½æ•°ä¼šé‡æ–°è®¡æ—¶clearTimeout(timer);timer = later();&#125;&#125;;&#125;; å¯¹äºæŒ‰é’®çš„ç‚¹å‡»æ¥è¯´ï¼Œå‡è®¾ä½ è¿ç»­ç‚¹å‡»äº† 10 æ¬¡ï¼Œå¦‚æœç½‘ç»œè¯·æ±‚é˜²æŠ–æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œåœ¨è¿™ 10 æ¬¡è¿‡ç¨‹ä¸­ï¼Œå‡½æ•°åªåœ¨ç‚¹å‡»çš„ç¬¬ä¸€æ¬¡ç«‹å³æ‰§è¡Œã€‚å…¶ä½™çš„ 9 æ¬¡éƒ½åœ¨é‡ç½®å®šæ—¶å™¨ï¼Œç­‰åˆ°æœ€åä¸€æ¬¡è®¾å®šçš„è®¡æ—¶å™¨è®¡æ—¶æ—¶é—´åˆ°ï¼Œå†æ¬¡ç‚¹å‡»æ‰é‡æ–°æ‰§è¡Œã€‚ èŠ‚æµç®€å•å¯ä»¥ç†è§£ä¸ºï¼šå°†å¤šæ¬¡æ‰§è¡Œçš„å‡½æ•°å›ºå®šæˆæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œã€‚ ä¸€èˆ¬æƒ…å†µä¸‹æœ‰ 2 ä¸­ä¸åŒçš„é™åˆ¶æ–¹å¼é€‚ç”¨ä¸åŒéœ€æ±‚ é¦–æ¬¡æ˜¯å¦æ‰§è¡Œ ç»“æŸåæ˜¯å¦æ‰§è¡Œ Codeä½¿ç”¨æ—¶é—´æˆ³å®ç°æ€è·¯ å˜é‡previousè®°å½•è°ƒç”¨æ–¹æ³•çš„æ—¶é—´æˆ³. å¯¹æ¯”ä¹‹å‰çš„æ—¶é—´é”™ï¼Œå¦‚æœå¤§äºè®¾ç½®çš„æ—¶é—´é”™ï¼Œåˆ™æ‰§è¡Œå‡½æ•°ã€‚æ‰§è¡Œåæ›´æ–°æ—¶é—´æˆ³ä¸ºå½“å‰æ—¶é—´ã€‚ 123456789101112const throttle = (func, delay) =&gt; &#123;let previous = 0;return function(...args) &#123;let now = +new Date();// å°†å½“å‰æ—¶é—´å’Œä¸Šä¸€æ¬¡æ‰§è¡Œå‡½æ•°æ—¶é—´å¯¹æ¯”// å¦‚æœå·®å€¼å¤§äºè®¾ç½®çš„ç­‰å¾…æ—¶é—´å°±æ‰§è¡Œå‡½æ•°if (now - previous &gt; delay) &#123;previous = now;func.apply(this, args);&#125;&#125;;&#125;; ä»£ç åˆ†æ 1.ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œif (now - previous &gt; delay)ï¼Œprevious=0ï¼Œæ‰€ä»¥æ–¹æ³•ç«‹å³æ‰§è¡Œï¼Œéšåè®°å½•previous=now()ï¼Œæ¯éš” 1s æ‰§è¡Œä¸€æ¬¡æ–¹æ³•ã€‚ 2.ä½†ä¸ä¼šè§¦å‘æœ€åä¸€æ¬¡æ‰§è¡Œã€‚ ä½¿ç”¨setTimeoutå®ç°æ€è·¯ å½“æ‰§è¡Œ throttle å‡½æ•°æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å®šæ—¶å™¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œ 123456789101112const throttle = (func, delay) =&gt; &#123;let timer;return function(...args) &#123;// å¦‚æœå®šæ—¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ã€‚if (!timer) &#123;timer = setTimeout(() =&gt; &#123;func.apply(this, args);timer = null;&#125;, delay);&#125;&#125;;&#125;; ä»£ç åˆ†æ å½“è¿ç»­è°ƒç”¨ throttle å‡½æ•°æ—¶ï¼Œæ–¹æ³•funcä¸ä¼šç«‹å³æ‰§è¡Œï¼Œä¹‹åæ ¹æ®è®¾å®šçš„ delay æ—¶é—´é—´éš”æ‰§è¡Œã€‚ ç»“æŸè°ƒç”¨åè¿˜ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚ ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«åœ¨ä¸æ˜¯å¦é¦–æ¬¡æ‰§è¡Œå’Œæ˜¯å¦ç»“æŸåæ‰§è¡Œã€‚ å®Œå–„æ€è·¯ å¢åŠ optionsé€‰é¡¹ï¼Œå¯é€‰ leading:false è¡¨ç¤ºç¦ç”¨ç¬¬ä¸€æ¬¡æ‰§è¡Œã€trailing:false è¡¨ç¤ºç¦ç”¨åœæ­¢è§¦å‘çš„å›è°ƒ 1234567891011121314151617181920212223242526272829const throttle = (func, delay, option) =&gt; &#123; let timer, previous = null; // const later = function() &#123; previous = option.leading === false ? 0 : +new Date(); func.apply(this, arguments); timer = null; &#125;; return function(...args) &#123; // å¦‚æœå®šæ—¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ã€‚ let now = +new Date(); // å¦‚æœleading===falseè¡¨ç¤ºç¬¬ä¸€æ¬¡è°ƒç”¨ä¸æ‰§è¡Œï¼› if (option.leading === false &amp;&amp; !previous) &#123; previous = now; &#125; // æ ¹æ®æ—¶é—´æˆ³å¯¹æ¯”æ˜¯å¦åœ¨é™åˆ¶æ—¶é—´å†… if (now - previous &gt; delay) &#123; if (timer) &#123; clearTimeout(timer); timer = null; &#125; func.apply(this, args); previous = now; &#125; else if (!timer &amp;&amp; option.trailing !== false) &#123; timer = setTimeout(later, delay); &#125; &#125;; &#125;;","link":"/2019/08/09/é˜²æŠ–ä¸èŠ‚æµ/"},{"title":"Hola","text":"å¿ƒæƒ…ä¸å¥½ï½å†™ç‚¹ä»€ä¹ˆâ€¦","link":"/2019/03/01/Hola/"},{"title":"æ‹¾é—webpack4ï¼ˆä¸€ï¼‰â€”â€”å…¥é—¨","text":"webpack4 åˆä½“éªŒwebpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å·¥å…·ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šåœ¨å†…éƒ¨æ„å»ºä¸€ä¸ª ä¾èµ–å›¾(dependency graph)ï¼Œæ­¤ä¾èµ–å›¾ä¼šæ˜ å°„é¡¹ç›®æ‰€éœ€çš„æ¯ä¸ªæ¨¡å—ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚ ä» 4.0 ç‰ˆæœ¬å¼€å§‹ï¼Œwebpack æŠ›å¼ƒä»¥å‰ç‰ˆæœ¬çš„é‚£ç§ç¹çã€æ™¦æ¶©ä»¤åˆå­¦è€…æ€¯æ­¥çš„é…ç½®æ–‡ä»¶ï¼Œå¼€å§‹é›¶é…ç½®é æ‹¢ï¼› è¿™æ— ç–‘å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œäº²å’ŒåŠ›ä¸Šäº†ä¸€å±‚æ¥¼ã€‚ ä½†å®ƒä»ç„¶å…·æœ‰å¯é…ç½®æ€§æ»¡è¶³å¤šç§éœ€æ±‚ã€‚ åœ¨å¼€å§‹ä¹‹å‰å…ˆäº†è§£æ ¸å¿ƒæ¦‚å¿µ å…¥å£ï¼ˆentryï¼‰ è¾“å‡ºï¼ˆoutputï¼‰ loader æ’ä»¶ï¼ˆpluginï¼‰ æ¨¡å¼ï¼ˆmodeï¼‰ æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆbowser compatibilityï¼‰ é¡¹ç›®æ­å»ºåˆ›å»ºç©ºæ–‡ä»¶å¤¹ webpack_demoï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆ package.json 1npm init æˆ–è€… npm init -y Tip-y å‚æ•°è¡¨ç¤ºæ‰€æœ‰ package.json å‚ä¸ºé»˜è®¤ å¼•å…¥ webpack 1npm install webpack --save-dev è¿™é‡Œè¿˜éœ€è¦ä½¿ç”¨ webpack-cli è„šæ‰‹æ¶ 1npm install webpack-cli --save-dev æŸ¥çœ‹ package.json æ–‡ä»¶å¯ä»¥çœ‹åˆ°ç›®å‰ä½¿ç”¨çš„ç‰ˆæœ¬ 12345\"devDependencies\": &#123; \"webpack\": \"^4.30.0\", \"webpack-cli\": \"^3.3.0\" &#125; æ¥ä¸‹æ¥åœ¨ packege.json ä¸­å¢åŠ  npm scripts 12345\"scripts\": &#123; \"build\": \"webpack\", \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" &#125; åˆ°è¿™é‡ŒåŸºæœ¬çš„é¡¹ç›®æ­å»ºå®Œæ¯•ï¼Œè¿è¡Œ npm run build å‘½ä»¤çœ‹çœ‹æ•ˆæœã€‚ ä»å›¾ç‰‡é‡Œçš„æŠ¥é”™ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼šâ€œæœªèƒ½æ‰¾åˆ°å…¥å£æ–‡ä»¶â€ å›åˆ°æ–‡ç« å¼€å§‹è®²çš„ï¼šwebpack ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼šå…¥å£(entry) å…¥å£(entry)å…¥å£èµ·ç‚¹(entry point)æŒ‡ç¤º webpack åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—ï¼Œæ¥ä½œä¸ºæ„å»ºå…¶å†…éƒ¨ ä¾èµ–å›¾(dependency graph) çš„å¼€å§‹ã€‚è¿›å…¥å…¥å£èµ·ç‚¹åï¼Œwebpack ä¼šæ‰¾å‡ºæœ‰å“ªäº›æ¨¡å—å’Œåº“æ˜¯å…¥å£èµ·ç‚¹ï¼ˆç›´æ¥å’Œé—´æ¥ï¼‰ä¾èµ–çš„ã€‚ https://webpack.docschina.org/concepts/#%E5%85%A5%E5%8F%A3-entry- webpack çš„å…¥å£é»˜è®¤æ˜¯ .src/index.js ,ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ webpack.config.js ä¸­å»é…ç½®æŒ‡å®šå…·ä½“çš„å…¥å£èµ·ç‚¹ã€‚ webpack.config.js 12345module.exports = &#123; entry: &#123; app: \"./app.js\" &#125;&#125;; ç°åœ¨æ–°å»ºä¸€ä¸ªsrcç›®å½•å¹¶æ·»åŠ å…¥å£æ–‡ä»¶ index.js è¿è¡Œnpm run build,å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºæ‰“åŒ…æˆåŠŸ å¹¶åœ¨ç›®å½•ä¸‹åˆ›å»ºäº†distæ–‡ä»¶å¤¹å’Œé‡Œé¢å·²ç»æ‰“åŒ…å‹ç¼©å¥½çš„æ–‡ä»¶main.js è¿™é‡Œè®²ä¸€ä¸ª webpack çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šè¾“å‡ºï¼ˆoutputï¼‰ è¾“å‡º(output)output å±æ€§å‘Šè¯‰ webpack åœ¨å“ªé‡Œè¾“å‡ºå®ƒæ‰€åˆ›å»ºçš„ bundleï¼Œä»¥åŠå¦‚ä½•å‘½åè¿™äº›æ–‡ä»¶ã€‚ä¸»è¦è¾“å‡ºæ–‡ä»¶çš„é»˜è®¤å€¼æ˜¯ ./dist/main.jsï¼Œå…¶ä»–ç”Ÿæˆæ–‡ä»¶é»˜è®¤æ”¾ç½®åœ¨ ./dist æ–‡ä»¶å¤¹ä¸­ã€‚ https://webpack.docschina.org/concepts/#%E5%85%A5%E5%8F%A3-entry- åŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨webpack.config.js ä¸­å»è‡ªå®šä¹‰è¾“å‡ºç‚¹(output) webpack.config.js 1234567module.exports = &#123; output: &#123; publicPath: __dirname + \"/dist/\", // js å¼•ç”¨çš„è·¯å¾„æˆ–è€…CDNåœ°å€ path: path.resolve(__dirname, \"dist\"), // æ‰“åŒ…æ–‡ä»¶çš„è¾“å‡ºç›®å½• filename: \"bundle.js\" // æ‰“åŒ…åç”Ÿäº§çš„jsæ–‡ä»¶ &#125;&#125;; æ¨¡å¼(mode)å‰é¢è¿è¡Œnpm run build çš„è¿‡ç¨‹ä¸­ï¼Œè™½ç„¶æ‰“åŒ…æˆåŠŸï¼Œä½†æ˜¯æ§åˆ¶å°è¿˜è¾“å‡ºå‡ è¡Œè­¦å‘Šä¿¡æ¯: â€œæ²¡æœ‰è®¾ç½® mode optionâ€ è¿™é‡Œå°±è¦è®²åˆ° webpack ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒç‚¹ï¼šmodeï¼Œ production development æˆ‘ä»¬å¯ä»¥åœ¨npm scripts ä¸­å‘Šè¯‰webpack-cli ä»¥ä»€ä¹ˆæ ·çš„ mode å»æ„å»ºä¾‹å¦‚: 1234567&#123; \"scripts\": &#123; \"dev\": \"webpack --mode development\", \"build\": \"webpack --mode production\", \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\" &#125;&#125; æˆ–è€…åœ¨webpack.config.jsä¸­è®¾ç½® 123module.exports = &#123; mode: \"production\"&#125;; å¦‚æœä¸è®¾ç½®çš„è¯ï¼Œé»˜è®¤modeä¸ºproduction ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ä¸­æ¨¡å¼ä¸‹çš„ç®€å•åŒºåˆ« æ‰§è¡Œ npm run dev æ‰§è¡Œ npm run build é€šè¿‡å¯¹æ¯”ï¼Œåœ¨ dev æ¨¡å¼ä¸‹ï¼Œjs æ–‡ä»¶æ²¡æœ‰è¢«å‹ç¼© ä¸€ä¸ªå®Œæ•´çš„ Web é¡¹ç›®é™¤äº† js è„šæœ¬æ–‡ä»¶ï¼Œåº”è¯¥è¿˜åŒ…å«æœ‰ CSSã€HTML ä»¥åŠå…¶ä»–èµ„æºï¼Œå¦‚å›¾ç‰‡ã€å­—ä½“ç­‰;é‚£ä¹ˆåœ¨ webpack ä¸­å¦‚ä½•å»å¤„ç†è¿™äº›èµ„æºå‘¢ï¼Ÿé¦–å…ˆä»å¤„ç† CSS å¼€å§‹ loaderwebpack åªèƒ½ç†è§£ JavaScript å’Œ JSON æ–‡ä»¶ã€‚loader è®© webpack èƒ½å¤Ÿå»å¤„ç†å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºæœ‰æ•ˆ æ¨¡å—ï¼Œä»¥ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œä»¥åŠè¢«æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­ã€‚ https://webpack.docschina.org/concepts/#loader 1ã€æ·»åŠ style.css2ã€å¤„ç† css éœ€è¦å®‰è£…ä»¥ä¸‹ loader é…åˆä½¿ç”¨ï¼Œæ‰§è¡Œnpm i --save-dev style-loader css-loader css-loaderï¼šè§£æ CSS ä»£ç ï¼Œå¤„ç† CSS ä¸­çš„ä¾èµ–ï¼ˆ@importã€url()ç­‰ï¼‰ style-loaderï¼šå°†css-loaderè§£æç»“æœè½¬å˜ä¸º js å¹¶åŠ¨æ€æ’å…¥ style æ ‡ç­¾ 123456\"devDependencies\": &#123; \"css-loader\": \"^2.1.1\", \"style-loader\": \"^0.23.1\", \"webpack\": \"^4.30.0\", \"webpack-cli\": \"^3.3.0\" &#125; 3ã€é…ç½®webpack.config.js 12345678910module.exports = &#123; module: &#123; rules: [ &#123; test: /\\.css$/, use: [\"style-loader\", \"css-loader\"] &#125; ] &#125;&#125;; 4ã€style.css 123.hola &#123; color: blue;&#125; 5ã€åœ¨index.jsä¸­ å¼•å…¥style.css 1import \"./style.css\"; 6ã€æ‰§è¡Œnpm run build 7ã€åœ¨index.htmlä¸­å¼•å…¥æ‰“åŒ…å¥½çš„æ–‡ä»¶bundle.js 8ã€åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ index.html,åœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ° css æ ·å¼å·²ç»é€šè¿‡&lt;style&gt; æ ‡ç­¾æ³¨å…¥ å¤„ç†sassã€lessï¼Œå¯ä»¥ä½¿ç”¨less-loader\\sass-loader æ’ä»¶ï¼ˆpluginï¼‰åœ¨ html æ–‡ä»¶ä¸­å¼•å…¥æ‰“åŒ…å¥½åçš„ js æ–‡ä»¶ï¼Œå¦‚æœæ›´æ”¹äº†æ‰“åŒ…åçš„æ–‡ä»¶åç§°æˆ–è€…ä»£ç åˆ†å‰²æˆå¤šä¸ªæ–‡ä»¶ï¼Œåˆè¦å»ä¸€ä¸ªä¸ªå¼•å…¥ï¼Œç”šæ˜¯éº»çƒ¦ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨html-webpack-pluginï¼Œæ‰“åŒ…å®Œä¹‹åè‡ªåŠ¨ç”Ÿæˆ HTML æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨å¼•å…¥æ‰“åŒ…åçš„ js æ–‡ä»¶ã€‚ 1ã€æ‰§è¡Œnpm i html-webpack-plugin html-loader --save-dev2ã€é…ç½®webpack.config.js3ã€æ‰§è¡Œnpm run build4ã€åœ¨distæ–‡ä»¶å¤¹ä¸‹æ‰“å¼€index.html è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨å‰ï¼Œè¿™é‡Œè¦æŠŠwebpackçš„outputæ”¹ä¸ºç›¸å¯¹è·¯å¾„publicPath:&#39;./&#39;","link":"/2019/03/02/æ‹¾é—webpack4ï¼ˆä¸€ï¼‰â€”â€”å…¥é—¨/"},{"title":"æ‹¾é—webpack4ï¼ˆä¸‰ï¼‰â€”â€”å¤„ç†å›¾ç‰‡","text":"","link":"/2019/03/05/æ‹¾é—webpack4ï¼ˆä¸‰ï¼‰â€”â€”å¤„ç†å›¾ç‰‡/"},{"title":"æ‹¾é—webpack4ï¼ˆäºŒï¼‰â€”â€”Babel","text":"BabelBabel æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦ç”¨äºå°† ECMAScript 2015+ ç‰ˆæœ¬çš„ä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹çš„ JavaScript è¯­æ³•ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œåœ¨å½“å‰å’Œæ—§ç‰ˆæœ¬çš„æµè§ˆå™¨æˆ–å…¶ä»–ç¯å¢ƒä¸­ã€‚ 1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€éœ€è¦çš„ package 12npm install --save-dev babel-loader @babel/core @babel/preset-envnpm install --save @babel/polyfill babel-loader : è¿™æ˜¯ Webpack çš„ Babel æ’ä»¶ï¼Œå®ƒå°†è¢«æ·»åŠ åˆ° Webpack é…ç½®ä¸­ï¼Œä»¥æŒ‡ç¤ºå®ƒåœ¨æ†ç»‘è¿‡ç¨‹ä¸­é€šè¿‡ Babel è¿è¡Œç›®æ ‡æ–‡ä»¶ï¼› @babel/core @babel/preset-envï¼šé€šè¿‡æ ¹æ®ç›®æ ‡æµè§ˆå™¨æˆ–è¿è¡Œæ—¶ç¯å¢ƒè‡ªåŠ¨ç¡®å®šæ‰€éœ€çš„ Babel æ’ä»¶å’Œ polyfillï¼Œå°†ä»£ç ç¼–è¯‘ä¸º ES5 @babel/polyfillï¼šå«ç‰‡ï¼Œè½¬åŒ– ES6 å†…ç½®è¯­æ³•ï¼ˆArray.from,Object.assign ç­‰ï¼‰ 1234567891011\"devDependencies\": &#123; \"@babel/core\": \"^7.4.3\", \"@babel/preset-env\": \"^7.4.3\", \"babel-loader\": \"^8.0.5\", \"clean-webpack-plugin\": \"^2.0.1\", \"webpack\": \"^4.30.0\", \"webpack-cli\": \"^3.3.0\" &#125;, \"dependencies\": &#123; \"@babel/polyfill\": \"^7.4.3\" &#125; 2ã€æ–°å»º babel é…ç½®æ–‡ä»¶.babelrc æ¥é…ç½® babel 123&#123; \"presets\": [\"@babel/preset-env\"]&#125; 3ã€åœ¨webpack.config.jsä¸­é…ç½® babel-loader 123456789module: &#123; rules: [ &#123; test: /\\.js$/, //åŒ¹é…jsæ–‡ä»¶ exclude: /node_modules/, //å¿½ç•¥ç›®æ ‡æ–‡ä»¶å¤¹ loader: \"babel-loader\" // ä½¿ç”¨babel-loader &#125; ];&#125; 4ã€éªŒè¯ åœ¨ index.js ä¸­ä½¿ç”¨ ES6 è¯­æ³• 12345// import '@babel/polyfill'const arr = [\"1\", \"2\", \"3\"];const fn = () =&gt; console.log(...arr);fn(); è¿™é‡Œè¿˜éœ€è¦import &#39;@babel/polyfill&#39;å…¨å±€å¼•å…¥æ‰“åŒ…åä½“ç§¯å¤§ã€æ ¹æ®éœ€è¦è½¬è¯‘çš„æ–‡ä»¶æŒ‰éœ€å¼•ç”¨åˆå¾ˆéº»çƒ¦ï¼Œè¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸‹babelrcï¼Œbabel è‡ªåŠ¨è½¬è¯‘ .babelrc1234567891011&#123; \"presets\": [ [ \"@babel/preset-env\", &#123; \"useBuiltIns\": \"usage\", \"corejs\": \"3\" //ä½¿ç”¨core-js@3ç‰ˆæœ¬ &#125; ] ]&#125; è¿™é‡Œé‡åˆ°ä¸€ä¸ªå°å‘ï¼Œé…ç½®å®Œ.babelrcåæ‰§è¡Œnpm run buildï¼Œæ§åˆ¶å°é¦–å…ˆä¼šæç¤ºä¸€æ®µè­¦å‘Š: å¤§æ¦‚æ„æ€å°±æ˜¯æŒ‡å®šç”¨ä»€ä¹ˆç‰ˆæœ¬çš„core-js,é»˜è®¤ä½¿ç”¨core-js@2ç‰ˆæœ¬ ç„¶åæŠ¥é”™ è¿™é‡Œé…ç½®ä¸€ä¸‹core-jsçš„ç‰ˆæœ¬ æ‰§è¡Œnpm run build æµè§ˆå™¨ä¸­æ‰“å¼€distæ–‡ä»¶å¤¹ä¸‹çš„index.htmlï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºã€‚ Chrome æœ€æ–°ç‰ˆæ˜¯æ”¯æŒ ES6 è¯­æ³•çš„ï¼Œæœ€å¥½çš„è¿˜æ˜¯åœ¨ IE ä¸‹æµ‹è¯•ã€‚","link":"/2019/03/04/æ‹¾é—webpack4ï¼ˆäºŒï¼‰â€”â€”Babel/"},{"title":"The Boring Projectâ€”â€”é©¾æ ¡ç®¡ç†ç³»ç»Ÿ","text":"ï½ 1","link":"/2019/08/11/The-Boring-Projectâ€”â€”é©¾æ ¡ç®¡ç†ç³»ç»Ÿ/"},{"title":"æ‹¾é—JavaScriptâ€”â€”åŸå‹ä¸åŸå‹é“¾","text":"ä¸€ã€åŸå‹prototypeåŸºæœ¬ä¸Šæ¯ä¸ªå‡½æ•°éƒ½æœ‰ ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§â€”â€”åŸå‹ï¼ˆprototypeï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ˜¾å¼å±æ€§ã€‚ å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°æ—¶ï¼Œè¿™ä¸ªå±æ€§å°±è‡ªåŠ¨è¢«åˆ›å»ºã€‚ 1function fn()&#123;&#125; å‡½æ•°çš„prototypeæ˜¯ä»€ä¹ˆï¼Ÿ prototype å±æ€§ï¼šç»§æ‰¿æˆå‘˜å®šä¹‰çš„åœ°æ–¹ã€‚ é€šä¿—çš„ç†è§£ä¸ºï¼šå½“æˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡ä¼šä»åŸå‹ä¸­â€œç»§æ‰¿â€å±æ€§å’Œæ–¹æ³•ã€‚ 12345678910111213141516function animal()&#123;&#125;;animal.prototype.class = \"animal\";animal.prototype.eat = function() &#123; console.log(\"eat something\");&#125;var cat = new animal();cat.eat(); // eat somethingconsole.log(cat.class); // \"animal\" ğŸ˜ª æŠ½è±¡èƒ½åŠ›å·®æ€ä¹ˆåŠï¼Ÿâ€”â€”â€”â€”ç”»å›¾ å½“æˆ‘ä»¬æ‰“å°catè¿™ä¸ªå®ä¾‹æ—¶â€¦â€¦.. Whatï¼Ÿï¼Ÿï¼Ÿ OOPæ€æƒ³ä¸­çš„ç»§æ‰¿ï¼ˆjavaï¼ŒC++ç­‰ï¼‰æ˜¯ä¸€ç§å¯¹å±æ€§æ–¹æ³•çš„å¤åˆ¶æ“ä½œï¼Œä½†å¯¹è±¡å®ä¾‹catä¸­å¹¶æ²¡æœ‰å¤åˆ¶è¿‡æ¥çš„å±æ€§å’Œæ–¹æ³•ï¼Œä½†åœ¨è°ƒç”¨classå±æ€§å’Œeat()æ–¹æ³•æ—¶éƒ½å¯ä»¥æ­£å¸¸è°ƒç”¨ã€‚è¿™ï¼Ÿï¼Ÿï¼Ÿåœ¨JavaScript çš„ç»§æ‰¿æ“ä½œå…¶å®æ˜¯ä¸€ç§â€œé“¾æ¥â€æ“ä½œï¼Œæ˜¯ä¸€ç§å§”æ‰˜ï¼Œé€šè¿‡__proto__ é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„prototypeã€‚ __proto____proto__ æ˜¯æ¯ä¸€ä¸ªå¯¹è±¡ï¼ˆé™¤äº†nullï¼‰éƒ½æœ‰çš„éšå¼å±æ€§ï¼Œå®ƒæŒ‡å‘åˆ›å»ºè¯¥å¯¹è±¡çš„æ„é€ å‡½æ•°çš„[[prototype]]ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°å®šä¹‰åœ¨æ„é€ å‡½æ•°çš„prototypeä¸Šçš„å±æ€§å’Œæ–¹æ³•ã€‚ 1console.log(cat.__proto__ == animal.prototype); // true å½“ä½¿ç”¨cat.__proto__ æ—¶ï¼Œå®é™…ä¸Šæ˜¯è¿”å›Object.getPrototypeOf(cat)ã€‚å¯ä»¥ç†è§£ä¸ºä¸€ç§getter/setteræ“ä½œã€‚ ğŸ˜ª æŠ½è±¡èƒ½åŠ›å·®æ€ä¹ˆåŠï¼Ÿâ€”â€”ç”»å›¾ constructor åœ¨animal.prototypeä¸­è¿˜æœ‰ä¸€ä¸ªå±æ€§constructor,å®ƒæ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿ constructor:æ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½ä»åŸå‹ä¸­ç»§æ‰¿ä¸€ä¸ª constructor å±æ€§ï¼Œå®ƒæŒ‡å‘æ„é€ æ­¤å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼› å› æ­¤å®ä¾‹catçš„æ„é€ å‡½æ•°æ˜¯function animal() 12console.log(animal.prototype.constructor === animal); // trueconsole.log(cat.constructor === animal); // true æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·å»åˆ›å»ºanimalçš„å®ä¾‹ï¼Œä½†ä¸€èˆ¬æ¥è¯´çŸ¥é“åŸå§‹æ„é€ å™¨function animal()çš„æƒ…å†µä¸‹ä¸ä¼šç”¨è¿™æ ·çš„æ–¹å¼ã€‚ 1234const dog = new cat.constructor();dog.class // animaldog.eat() // eat somethingconsole.log(dog.constructor === animal); // true ç”»å›¾æ‹ä¸€æ‹ï½ åŸå‹çš„åŸå‹ ï¼Ÿæ‹æ¸…äº†å®ä¾‹ä¸åŸå‹çš„å…³ç³»,é‚£åŸå‹çš„åŸå‹æ˜¯ä»€ä¹ˆï¼Ÿ animal.prototype ä¸­ä¹Ÿæœ‰ä¸€ä¸ªå±æ€§__proto__ , è¿™ä¸ª__proto__å±æ€§æŒ‡å‘å“ªï¼Ÿ åœ¨JavaScriptä¸­ï¼Œå‡½æ•°å…¶å®ä¹Ÿæ˜¯Objectï¼Œanimal.prototype.__proto__ æŒ‡å‘çš„æ˜¯Object.prototype è€ŒObject.prototype.__proto__ === null åŸå‹é“¾1234567891011121314function animal()&#123;&#125;;animal.prototype.class = \"animal\";var cat = new animal();cat.class = \"cat\";console.log(cat.class); // catdelete cat.class; // åˆ é™¤ cat çš„ class å±æ€§console.log(cat.class); // animalcat.isPrototypeOf();cat.valueOf() ç”±ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡º:1ã€cat.class é¦–å…ˆåœ¨å®ä¾‹catä¸Šå¯»æ‰¾å±æ€§classï¼Œè¾“å‡ºâ€œcatâ€2ã€åˆ é™¤å®ä¾‹catä¸Šçš„å±æ€§classï¼Œä»èƒ½è°ƒç”¨ï¼Œä½†è¾“å‡ºçš„æ˜¯&quot;animal&quot;è¿™æ˜¯å› ä¸ºå½“åœ¨å®ä¾‹ä¸Šå¯»æ‰¾ä¸åˆ°å±æ€§classæ—¶ï¼Œä¼šé€šè¿‡__proto__æ‰¾åˆ°aminal.prototypeï¼Œåœ¨ä¸Šé¢å¯»æ‰¾åˆ°classï¼Œå¹¶è¾“å‡º&quot;animal&quot;3ã€å¹¶æ²¡æœ‰åœ¨å®ä¾‹catæˆ–è€…animal.prototypeä¸Šå®šä¹‰isPrototypeOf()/valueOf()ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½è°ƒç”¨ï¼Ÿè¿™æ˜¯å› ä¸ºå½“åœ¨å®ä¾‹ã€å®ä¾‹åŸå‹animal.prototypeä¸Šæ‰¾ä¸æ—¶ï¼Œè§£æå™¨ä¼šç»§ç»­å¾€ä¸Šï¼Œå³animal.prototype.__proto__ï¼Œç›´åˆ°__proto__æŒ‡å‘nullåˆ™åœæ­¢å¯»æ‰¾ã€‚æ­¤æ—¶animal.prototype.__proto__æŒ‡å‘çš„æ˜¯Object.prototypeï¼Œæ‰€ä»¥è°ƒç”¨ä¸Šé¢å®šä¹‰çš„æ–¹æ³•isPrototypeOf()/valueOf() å®ä¾‹catã€æ„é€ å‡½æ•°animalçš„åŸå‹prototypeã€Object.prototype ä»¥__proto__é“¾æ¥èµ·æ¥çš„å…³ç³»å°±å½¢æˆäº†åŸå‹é“¾ã€‚ å›¾è…¾","link":"/2019/04/10/æ‹¾é—JavaScriptâ€”â€”åŸå‹ä¸åŸå‹é“¾/"},{"title":"æ‹¾é—JavaScriptâ€”â€”Promise","text":"åŸºæœ¬ä½¿ç”¨æ²¡å•¥å¥½è®°å½•ï½ å…·ä½“å‚è€ƒ MDN Promise https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise Promise å…·ä½“ç”¨æ³• https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Using_promises Promise.all()Promise.all() å‚æ•°ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚ Array æˆ– Stringã€‚ è¿”å›å€¼ å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªç©ºçš„å¯¹è±¡ï¼Œåˆ™è¿”å›ä¸€ä¸ªå·²å®Œæˆï¼ˆalready resolvedï¼‰çŠ¶æ€çš„ Promiseã€‚ å¦‚æœä¼ å…¥çš„å‚æ•°ä¸åŒ…å«ä»»ä½• promiseï¼Œåˆ™è¿”å›ä¸€ä¸ªå¼‚æ­¥å®Œæˆï¼ˆasynchronously resolvedï¼‰ Promiseã€‚ 1ã€Promise.all è¿”å›çš„ promise çš„å®ŒæˆçŠ¶æ€çš„ç»“æœéƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚2ã€å¦‚æœæ‰€æœ‰ä¼ å…¥çš„ promise éƒ½å˜ä¸ºå®ŒæˆçŠ¶æ€ï¼Œæˆ–è€…ä¼ å…¥çš„å¯è¿­ä»£å¯¹è±¡å†…æ²¡æœ‰ promiseï¼ŒPromise.all è¿”å›çš„ promise å¼‚æ­¥åœ°å˜ä¸ºå®Œæˆ3ã€å¦‚æœä¼ å…¥çš„ promise ä¸­æœ‰ä¸€ä¸ªå¤±è´¥ï¼ˆrejectedï¼‰ï¼ŒPromise.all å¼‚æ­¥åœ°å°†å¤±è´¥çš„é‚£ä¸ªç»“æœç»™å¤±è´¥çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œè€Œä¸ç®¡å…¶å®ƒ promise æ˜¯å¦å®Œæˆï¼Œä»è€Œä¸¢å¼ƒå…¶ä»–Promiseçš„å®Œæˆç»“æœã€‚ ğŸŒ°å½“æˆ‘ä»¬åœ¨åŒæ—¶å‘èµ·å¤šä¸ªç½‘ç»œè¯·æ±‚æ—¶ï¼Œå¯ä»¥ç”¨Promise.all()æ¥å¤„ç†ã€‚ promise.js12345678910111213141516function fetchData(url) &#123;return new Promise((resolve, reject) =&gt; &#123;const requet = new XMLHttpRequest();requet.open(\"GET\", url);requet.onload = () =&gt; resolve(requet.responseText);requet.onerror = () =&gt; reject(requet.statusText);requet.send();&#125;);&#125;const fetch_1 = fetchData(topNewsUrl)const fetch_2 = fetchData(topNewsUrl)const fetch_3 = fetchData(topNewsUrl)Promise.all([fetch_1,fetch_2,fetch_3]).then(res=&gt;&#123;console.log(res);&#125;) ä½†æ˜¯å½“Promise.all()ä¸­æœ‰ä¸€ä¸ªpromiseçš„çŠ¶æ€ä¸ºrejectedï¼Œåˆ™ä¼šæŠ›å¼ƒå…¶ä»–å·²å®Œæˆçš„ç»“æœã€‚ promise.js1234567891011const fetch_1 = fetchData(topNewsUrl);const fetch_2 = fetchData(topNewsUrl);const fetch_3 = Promise.reject(\"err\");Promise.all([fetch_1, fetch_2, fetch_3]).then(res =&gt; &#123;console.log(res);&#125;).catch(err =&gt; &#123;console.log(err);&#125;); ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦åŒæ—¶å¾—åˆ°æ­£ç¡®å¤„ç†çš„ç»“æœå’Œå¤±è´¥ç»“æœï¼Œå¯ä»¥è¿™æ ·å¤„ç†promise.js1234567891011121314151617const fetch_1 = fetchData(topNewsUrl);const fetch_2 = fetchData(topNewsUrl);// ç”¨ catch()æ•è·å½“å‰ promise reject(\"err\")ï¼Œå¹¶è¿”å›ã€‚// catch() è¿”å›å€¼æ˜¯ä¸€ä¸ª promiseï¼Œå¦‚æœä¸è¢« rejectedï¼Œåˆ™å®ƒæ˜¾ç¤ºä¸ºæˆåŠŸ(resolved)const fetch_3 = Promise.reject(\"err\").catch(err =&gt;&#123;return err;&#125;);const fetchs = [fetch_1, fetch_2, fetch_3];Promise.all(fetchs).then(res =&gt; &#123;console.log(res);&#125;).catch(err =&gt; &#123;console.log(err);&#125;); åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨Promise.allSettled() Promise.allSettled()Promise.allSettled()ï¼š æ— è®ºæ˜¯æˆåŠŸæˆ–æ‹’ç»ã€‚è¿”å›æ•°ç»„åŒ…å«åŸå§‹promisesé›†ä¸­æ¯ä¸ªpromiseçš„ç»“æœã€‚ 1234567const fetch_1 = Promise.resolve(1);const fetch_2 = Promise.reject(2);const fetch_3 = Promise.resolve(3);const fetchs = [fetch_1, fetch_2, fetch_3];console.log(Promise.allSettled(fetchs)); Promise.finally()finally() æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseã€‚åœ¨promiseç»“æŸæ—¶ï¼Œæ— è®ºç»“æœæ˜¯fulfilledæˆ–è€…æ˜¯rejectedï¼Œéƒ½ä¼šæ‰§è¡ŒæŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ºåœ¨Promiseæ˜¯å¦æˆåŠŸå®Œæˆåéƒ½éœ€è¦æ‰§è¡Œçš„ä»£ç æä¾›äº†ä¸€ç§æ–¹å¼ 12345678Promise.resolve(1) .then(res =&gt; console.log(res)) // 1 .catch(err =&gt; console.log(err)) .finally(() =&gt; console.log(\"finally\")); // finallyPromise.reject(2) .then(res =&gt; console.log(res)) .catch(err =&gt; console.log(err)) // 2 .finally(() =&gt; console.log(\"finally\")); //finally Promise ? async/awaitå½“ä¸€ä¸ªç½‘ç»œè¯·æ±‚éœ€è¦ä¾èµ–ä¸Šä¸€ä¸ªè¯·æ±‚çš„ç»“æœæ—¶ï¼š Promise Promise.js12345678910fetchData(topNewsUrl) .then(res =&gt; &#123; return res.data[0].id; &#125;) .then(itemID =&gt; &#123; return fetchData(newsDetailUtl + itemID); &#125;) .then(res =&gt; &#123; console.log(res); &#125;); async/await async/await.js12345async function asyncFetch() &#123; const news = await fetchData(topNewsUrl) const res = await fetchData(newsDetailUtl + news.data[0].id); console.log(res);&#125; å¯¹æ¯”ä¸¤è€…æ˜¾ç„¶async/await ä»£ç æ›´ç®€æ´å®¹æ˜“ç†è§£ã€‚ å®ç°ä¸€ä¸ª PromiseåŸºç¡€ç®€æ˜“ç‰ˆmyPromise.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869// Promiseä¸‰ç§çŠ¶æ€;const PENDING = \"pendding\"; //ç­‰å¾…const FULFILLED = \"fulfilled\"; // å®Œæˆconst REJECTED = \"rejected\"; //æ‹’ç»class myPromise &#123; constructor(executor) &#123; this.state = PENDING; //åˆå§‹çŠ¶æ€ this.value = null; // å®Œæˆç»“æœ this.reason = null; // æ‹’ç»åŸå›  const resolve = value =&gt; &#123; if (this.state === PENDING) &#123; this.value = value; // ä¿å­˜å®Œæˆç»“æœ this.state = FULFILLED; // ä¿å­˜çŠ¶æ€ä¸ºå®Œæˆ &#125; &#125;; const reject = value =&gt; &#123; if (this.state == PENDING) &#123; this.reason = value; // ä¿ç•™æ‹’ç»åŸå›  this.state = REJECTED; // ä¿å­˜çŠ¶æ€ä¸ºæ‹’ç» &#125; &#125;; /** * executor: Promiseä¸­é¦–å…ˆä¼ äº†ä¸€ä¸ªexecutorï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•° * executorå‡½æ•°ä¸­åˆä¼ äº†ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯resolveå’Œreject * @param resolve:æˆåŠŸå›è°ƒ * @param reject:æ‹’ç»å›è°ƒ */ executor(resolve, reject); &#125; /** * æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€å»æ‰§è¡Œç›¸å…³æˆåŠŸonFilfulled()æˆ–è€…å¤±è´¥onRejected()çš„å›è°ƒæ–¹æ³• * @param &#123;*&#125; onFulfilled ï¼šæˆåŠŸ * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ then(onFulfilled, onRejected) &#123; switch (this.state) &#123; case FULFILLED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onFilfulledï¼Œä¼ å…¥æˆåŠŸç»“æœ this.value onFulfilled(this.value); break; case REJECTED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onRejectedï¼Œä¼ å…¥æ‹’ç»ç»“æœ this.reason onRejected(this.reason); break; default: break; &#125; &#125; /** * * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ catch(onRejected) &#123; return this.then(null, onRejected); &#125;&#125;const p = new myPromise((resolve, reject) =&gt; &#123; resolve(1);&#125;);p.then(res =&gt; &#123; console.log(res); // 1&#125;); å¾ˆæ˜¾ç„¶ï¼Œæµ‹è¯•ç»“æœååº”ä»£ç æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœåŠ ä¸ªå¼‚æ­¥å‡½æ•°å‘¢ï¼Ÿ å¼‚æ­¥å¤„ç†myPromise.js12345678const p = new myPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(1); &#125;, 1000);&#125;);p.then(res =&gt; &#123; console.log(res); &#125;); å¾ˆæ˜¾ç„¶ï¼Œæ§åˆ¶å°ä¸ä¼šè¾“å‡ºä»€ä¹ˆï¼Œå› ä¸ºsetTimeoutæ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œä¼šè¢«åŠ å…¥åˆ°Task Queue å½“è°ƒç”¨then()æ—¶ï¼ŒmyPromise.state è¿˜æ˜¯ PENDINGï¼Œæ­¤æ—¶then()å‡½æ•°å¹¶ä¸çŸ¥é“åˆ°åº•æ˜¯æ‰§è¡ŒonFulfilled()ï¼Œè¿˜æ˜¯onRejected()ã€‚ æ”¹é€ â€¦.myPromise.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697// Promiseä¸‰ç§çŠ¶æ€;const PENDING = \"pendding\"; //ç­‰å¾…const FULFILLED = \"fulfilled\"; // å®Œæˆconst REJECTED = \"rejected\"; //æ‹’ç»class myPromise &#123; constructor(executor) &#123; this.state = PENDING; //åˆå§‹çŠ¶æ€ this.value = null; // å®Œæˆç»“æœ this.reason = null; // æ‹’ç»åŸå›  this.onFulfilledCallbacks = []; // ä¿å­˜å®Œæˆå›è°ƒ this.onRejectedCallbacks = []; // ä¿å­˜æ‹’ç»å›è°ƒ const resolve = value =&gt; &#123; if (this.state === PENDING) &#123; this.value = value; // ä¿å­˜å®Œæˆç»“æœ this.state = FULFILLED; // ä¿å­˜çŠ¶æ€ä¸ºå®Œæˆ // çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰å®Œæˆçš„å›è°ƒå‡½æ•°. this.onFulfilledCallbacks.map(cb =&gt; &#123; cb(); &#125;); &#125; &#125;; const reject = value =&gt; &#123; if (this.state == PENDING) &#123; this.reason = value; // ä¿ç•™æ‹’ç»åŸå›  this.state = REJECTED; // ä¿å­˜çŠ¶æ€ä¸ºæ‹’ç» // çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰æ‹’ç»çš„å›è°ƒå‡½æ•° this.onRejectedCallbacks.map(cb =&gt; &#123; cb(); &#125;); &#125; &#125;; try &#123; /** * executor: Promiseä¸­é¦–å…ˆä¼ äº†ä¸€ä¸ªexecutorï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•° * executorå‡½æ•°ä¸­åˆä¼ äº†ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯resolveå’Œreject * @param resolve:æˆåŠŸå›è°ƒ * @param reject:æ‹’ç»å›è°ƒ */ executor(resolve, reject); &#125; catch (err) &#123; // å¦‚æœå‡ºé”™ï¼Œç›´æ¥è¿›å…¥reject() reject(err); &#125; &#125; /** * æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€å»æ‰§è¡Œç›¸å…³æˆåŠŸonFilfulled()æˆ–è€…å¤±è´¥onRejected()çš„å›è°ƒæ–¹æ³• * @param &#123;*&#125; onFulfilled ï¼šæˆåŠŸ * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ then(onFulfilled, onRejected) &#123; switch (this.state) &#123; // é’ˆå¯¹å¯èƒ½å­˜åœ¨çš„å¼‚æ­¥è°ƒç”¨ï¼Œåœ¨PENDINGçŠ¶æ€æ—¶å°†å®Œæˆã€å¤±è´¥çš„å›è°ƒå‡½æ•°pushåˆ°å¯¹åº”çš„æ•°ç»„ä¸­ï¼Œå¾…çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œã€‚ // è¿™ç§æ–¹å¼å¯ä»¥ç§°ä¸ºè®¢é˜… case PENDING: this.onFulfilledCallbacks.push(() =&gt; &#123; onFulfilled(this.value); &#125;); this.onRejectedCallbacks.push(() =&gt; &#123; onRejected(this.reason); &#125;); break; case FULFILLED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onFilfulledï¼Œä¼ å…¥æˆåŠŸç»“æœ this.value onFulfilled(this.value); break; case REJECTED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onRejectedï¼Œä¼ å…¥æ‹’ç»ç»“æœ this.reason onRejected(this.reason); break; default: break; &#125; &#125; /** * æ•è·reject * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ catch(onRejected) &#123; return this.then(null, onRejected); &#125;&#125;const p = new myPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(1); &#125;, 1000);&#125;);p.then(res =&gt; &#123; console.log(res); // 1&#125;); then()é“¾å¼è°ƒç”¨ å¦‚æœä¸€ä¸ªthenæ–¹æ³•è¿”å›ä¸€ä¸ªæ™®é€šå€¼çš„è¯ï¼Œè¿™ä¸ªå€¼ä¼šä¼ é€’ç»™ä¸‹ä¸€ä¸ªthenä¸­ä½œä¸ºresolveæˆåŠŸçš„ç»“æœå¦‚æœä¸€ä¸ªthenæ–¹æ³•è¿”å›ä¸€ä¸ªpromiseçš„è¯ï¼Œä¼šæ ¹æ®è¿”å›çš„promiseæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå†³å®šä¸‹ä¸€ä¸ªthenæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ myPromise.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118// Promiseä¸‰ç§çŠ¶æ€;const PENDING = \"pendding\"; //ç­‰å¾…const FULFILLED = \"fulfilled\"; // å®Œæˆconst REJECTED = \"rejected\"; //æ‹’ç»class myPromise &#123; constructor(executor) &#123; this.state = PENDING; //åˆå§‹çŠ¶æ€ this.value = null; // å®Œæˆç»“æœ this.reason = null; // æ‹’ç»åŸå›  this.onFulfilledCallbacks = []; // ä¿å­˜å®Œæˆå›è°ƒ this.onRejectedCallbacks = []; // ä¿å­˜æ‹’ç»å›è°ƒ const resolve = value =&gt; &#123; // ä¸ºäº†ä¿è¯å‡½æ•°æ‰§è¡Œé¡ºåºï¼Œéœ€è¦å°†ä¸¤ä¸ªå‡½æ•°ä½“ä»£ç ä½¿ç”¨ setTimeout åŒ…è£¹èµ·æ¥ setTimeout(() =&gt; &#123; if (this.state === PENDING) &#123; this.value = value; // ä¿å­˜å®Œæˆç»“æœ this.state = FULFILLED; // ä¿å­˜çŠ¶æ€ä¸ºå®Œæˆ // çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰å®Œæˆçš„å›è°ƒå‡½æ•°. this.onFulfilledCallbacks.forEach(cb =&gt; &#123; cb(); &#125;); &#125; &#125;, 0); &#125;; const reject = value =&gt; &#123; //ä¸ºäº†ä¿è¯å‡½æ•°æ‰§è¡Œé¡ºåºï¼Œéœ€è¦å°†ä¸¤ä¸ªå‡½æ•°ä½“ä»£ç ä½¿ç”¨ setTimeout åŒ…è£¹èµ·æ¥ setTimeout(() =&gt; &#123; if (this.state == PENDING) &#123; this.reason = value; // ä¿ç•™æ‹’ç»åŸå›  this.state = REJECTED; // ä¿å­˜çŠ¶æ€ä¸ºæ‹’ç» // çŠ¶æ€å˜æ›´å ç«‹å³æ‰§è¡Œä¹‹å‰å­˜æ”¾åœ¨ç›¸åº”æ•°ç»„ä¸­æ‰€æœ‰æ‹’ç»çš„å›è°ƒå‡½æ•° this.onRejectedCallbacks.forEach(cb =&gt; &#123; cb(); &#125;); &#125; &#125;, 0); &#125;; try &#123; /** * executor: Promiseä¸­é¦–å…ˆä¼ äº†ä¸€ä¸ªexecutorï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•° * executorå‡½æ•°ä¸­åˆä¼ äº†ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯resolveå’Œreject * @param resolve:æˆåŠŸå›è°ƒ * @param reject:æ‹’ç»å›è°ƒ */ executor(resolve, reject); &#125; catch (err) &#123; // å¦‚æœå‡ºé”™ï¼Œç›´æ¥è¿›å…¥reject() reject(err); &#125; &#125; /** * æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çš„çŠ¶æ€å»æ‰§è¡Œç›¸å…³æˆåŠŸonFilfulled()æˆ–è€…å¤±è´¥onRejected()çš„å›è°ƒæ–¹æ³• * @param &#123;*&#125; onFulfilled ï¼šæˆåŠŸ * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ then(onFulfilled, onRejected) &#123; // return ä¸€ä¸ª promise return new myPromise((resolve, reject) =&gt; &#123; switch (this.state) &#123; // é’ˆå¯¹å¯èƒ½å­˜åœ¨çš„å¼‚æ­¥è°ƒç”¨ï¼Œåœ¨PENDINGçŠ¶æ€æ—¶å°†å®Œæˆã€å¤±è´¥çš„å›è°ƒå‡½æ•°pushåˆ°å¯¹åº”çš„æ•°ç»„ä¸­ï¼Œå¾…çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œã€‚ // è¿™ç§æ–¹å¼å¯ä»¥ç§°ä¸ºè®¢é˜… case PENDING: this.onFulfilledCallbacks.push(() =&gt; &#123; try &#123; const x = onFulfilled(this.value); resolve(x); &#125; catch (err) &#123; reject(err); &#125; &#125;); this.onRejectedCallbacks.push(() =&gt; &#123; try &#123; const x = onRejected(this.reason); resolve(x); &#125; catch (err) &#123; reject(err); &#125; &#125;); break; case FULFILLED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onFilfulledï¼Œä¼ å…¥æˆåŠŸç»“æœ this.value try &#123; const x = onFulfilled(this.value); resolve(x); &#125; catch (err) &#123; reject(err); &#125; break; case REJECTED: //æ‰§è¡ŒæˆåŠŸçš„å›è°ƒå‡½æ•°onRejectedï¼Œä¼ å…¥æ‹’ç»ç»“æœ this.reason try &#123; const x = onRejected(this.reason); resolve(x); &#125; catch (err) &#123; reject(err); &#125; break; default: break; &#125; &#125;); &#125; /** * æ•è·reject * @param &#123;*&#125; onRejected ï¼šæ‹’ç» */ catch(onRejected) &#123; return this.then(null, onRejected); &#125;&#125; æµ‹è¯•myPromise.js123456789101112131415161718192021222324const p = new myPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(1); &#125;, 1000);&#125;);p.then(res =&gt; &#123; console.log(res); // 1 return \"2\"; &#125;) .then(res =&gt; &#123; console.log(res); // 2 return &#123; a: 3 &#125;; &#125;) .then(res =&gt; &#123; console.log(res); // &#123;a:3&#125; return undefined; &#125;) .then(res =&gt; &#123; console.log(res); // undefined &#125;) .then(res =&gt; &#123; console.log(res); // undefined &#125;); thenä¸­å‡½æ•°è¿”å›å€¼çš„å¤„ç† éæ™®é€šå€¼æƒ…å†µã€‚ è¿™é‡Œè¿˜æœ‰ç±»å‹åˆ¤æ–­ã€å‚æ•°é€ä¼ ç­‰é—®é¢˜å¤„ç†ï¼Œåç»­å®Œæˆ Promise/A+è§„èŒƒ Promise/A+ è§„èŒƒ","link":"/2019/03/10/æ‹¾é—JavaScriptâ€”â€”Promise/"},{"title":"æ‹¾é—JavaScriptâ€”â€”Event Loop","text":"Event Loop ä¸€ã€åŸºç¡€çŸ¥è¯†1ã€è¿›ç¨‹ä¸çº¿ç¨‹ è¿›ç¨‹ï¼šåº”ç”¨ç¨‹åºçš„æ‰§è¡Œå®ä¾‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æ˜¯ç”±ç§æœ‰çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€ä»£ç ã€æ•°æ®ä¸ªå…¶ä»–ç³»ç»Ÿèµ„æºç»„æˆã€‚ çº¿ç¨‹ï¼šçº¿ç¨‹æ˜¯è¿›ç¨‹å†…çš„ä¸€ä¸ªç‹¬ç«‹æ‰§è¡Œå•å…ƒï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¹‹é—´å¯ä»¥è¿›è¡Œèµ„æºå…±äº«ã€‚ è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„å †æ ˆç©ºé—´å’Œæ•°æ®æ®µï¼Œæ¯å½“å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹å¿…é¡»åˆ†é…ç»™å®ƒç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œå»ºç«‹ä¼—å¤šçš„æ•°æ®è¡¨æ¥ç»´æŠ¤å®ƒçš„ä»£ç æ®µã€å †æ ˆæ®µå’Œæ•°æ®æ®µã€‚ çº¿ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„å †æ ˆç©ºé—´ï¼Œä½†æ˜¯å…±äº«æ•°æ®æ®µï¼Œå®ƒä»¬å½¼æ­¤ä¹‹é—´ä½¿ç”¨ç›¸åŒçš„åœ°å€ç©ºé—´ï¼Œå…±äº«å¤§éƒ¨åˆ†æ•°æ®ï¼Œæ¯”è¿›ç¨‹æ›´åŠ èŠ‚ä¿­ï¼Œå¼€é”€æ¯”è¾ƒå°ï¼Œåˆ‡æ¢é€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜ã€‚ ä¸€å¥è¯æ€»ç»“: è¿›ç¨‹ï¼šèµ„æºåˆ†é…çš„æœ€å°å•ä½ çº¿ç¨‹ï¼šç¨‹åºæ‰§è¡Œçš„æœ€å°å•ä½ Javascriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€Why??ä¼—æ‰€å‘¨çŸ¥ï¼Œå¤šçº¿ç¨‹æ“ä½œå¯ä»¥å®ç°åº”ç”¨çš„å¹¶è¡Œå¤„ç†ï¼Œå……åˆ†åˆ©ç”¨CPUèµ„æºæé«˜æ€§èƒ½å’Œååé‡ã€‚ç°åœ¨å¾ˆå¤šè¯­è¨€éƒ½æ”¯æŒå¤šæ ¸å¹¶è¡Œå¤„ç†æŠ€æœ¯ã€‚ ä½†Javascriptâ€¦.ğŸ˜‚ Javascript æ˜¯ä¸€é—¨è„šæœ¬è¯­è¨€ï¼Œæœ€åˆè®¾è®¡ç”¨äºè¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œè¯•æƒ³ä¸€ä¸‹å¦‚æœæœ‰2ä¸ªåŒæ­¥çº¿ç¨‹åœ¨è·‘ï¼Œä¸€ä¸ªåœ¨æ‰§è¡ŒDOMçš„æ’å…¥ï¼Œå¦ä¸€ä¸ªåˆ é™¤DOMï¼Œæµè§ˆå™¨ä¼šï¼Ÿï¼Ÿï¼Ÿï¼Ÿ Soâ€¦è¿™æ„å‘³ç€å®ƒå¯ä»¥ä¸€æ¬¡å¤„ç†ä¸€ä¸ªä»»åŠ¡æˆ–ä¸€æ¬¡å¤„ç†ä¸€æ®µä»£ç ã€‚å®ƒæœ‰ä¸€ä¸ªè°ƒç”¨å †æ ˆï¼Œå®ƒä¸å †ä¹‹ç±»çš„å…¶ä»–éƒ¨åˆ†ä¸€èµ·æ„æˆäº†Javascriptå¹¶å‘æ¨¡å‹ï¼ˆåœ¨V8å†…éƒ¨å®ç°ï¼‰ã€‚ Call StackCall Stackï¼šå®ƒæ˜¯ä¸€ä¸ªè®°å½•å‡½æ•°è°ƒç”¨çš„æ•°æ®ç»“æ„ï¼Œå½“æˆ‘ä»¬è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‡½æ•°ä¼šè¢«æ¨å…¥è¿™ä¸ªå †æ ˆï¼Œä½†å‡½æ•°è¿”å›æ—¶æŒ‰å…ˆå…¥åå‡ºçš„è§„åˆ™ä¾æ¬¡æ¨å‡ºã€‚ 123456789101112function multiply(a, b) &#123; return a * b;&#125;function square(n) &#123; return multiply(n, n);&#125;function printSquare(n) &#123; var squared = square(n); console.log(squared);&#125;printSquare(4); é€šè¿‡æ–­ç‚¹è°ƒè¯•å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°è°ƒç”¨å †æ ˆ å½“å‡½æ•°æ‰§è¡Œå®Œè¿”å›æ—¶ï¼Œä¾æ¬¡ä»æ ˆé¡¶æ¨å‡ºã€‚ Heapheapï¼šå˜é‡æ‰€æœ‰çš„å†…å­˜åˆ†é…éƒ½åœ¨åœ¨å †ä¸­è¿›è¡Œã€‚ QueueJavascriptå•çº¿ç¨‹ä»»åŠ¡è¢«åˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡ä¼šåœ¨è°ƒç”¨æ ˆä¸­æŒ‰ç…§é¡ºåºç­‰å¾…ä¸»çº¿ç¨‹ä¾æ¬¡æ‰§è¡Œï¼Œå¼‚æ­¥ä»»åŠ¡ä¼šåœ¨å¼‚æ­¥ä»»åŠ¡æœ‰äº†ç»“æœåï¼Œå°†æ³¨å†Œçš„å›è°ƒå‡½æ•°æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…ä¸»çº¿ç¨‹ç©ºé—²çš„æ—¶å€™ï¼ˆè°ƒç”¨æ ˆè¢«æ¸…ç©ºï¼‰ï¼Œè¢«è¯»å–åˆ°æ ˆå†…ç­‰å¾…ä¸»çº¿ç¨‹çš„æ‰§è¡Œã€‚ 1234567891011console.log(\"1\");setTimeout(() =&gt; &#123; console.log(\"2\");&#125;, 3 * 1000);console.log(\"3\");// 1// 3// 2 å¦‚å›¾æ‰€ç¤ºï¼šæ‰§è¡Œæ ˆå…ˆå¤„ç†åŒæ­¥ä»»åŠ¡console.log(&#39;1&#39;)ï¼Œæ‰§è¡Œå®Œåæ¨å‡ºæ ˆï¼Œæ§åˆ¶å°è¾“å‡º1,setTimeout()è¿›å…¥æ‰§è¡Œæ ˆä½†ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯ç”±Web API å¤„ç†å®Œæ¯•åï¼ŒåŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ç­‰å¾…æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œï¼ŒåŒæ­¥ä»»åŠ¡console.log(&#39;3&#39;)è¿›å…¥æ‰§è¡Œæ ˆï¼Œæ‰§è¡Œå®Œæ¯•åæ¨å‡ºæ ˆï¼Œå½“æ‰§è¡Œæ ˆä¸ºnullæ—¶ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ¨å…¥æ‰§è¡Œæ ˆæ‰§è¡Œã€‚ æ•´ä¸ªè¿‡ç¨‹æ˜¯å¾ªç¯ä¸æ–­çš„ï¼Œè¿™æ ·çš„è¿è¡Œæœºåˆ¶ç§°ä¸ºEvent Loop Event Loop ä¾µåˆ  è¡¥å……å®ä»»åŠ¡/å¾®ä»»åŠ¡å®ä»»åŠ¡ï¼ˆTaskï¼‰ï¼š æ•´ä½“ä»£ç script setTimeout setInterval setImmediate requestAnimationFrame I/O UI rendering å¾®ä»»åŠ¡(Microtask)ï¼š Promiseï¼ˆPromiseä¸­çš„thenã€catchæ‰æ˜¯å®ä»»åŠ¡ï¼Œæœ¬èº«å†…éƒ¨ä»£ç å¹¶ä¸æ˜¯ï¼‰ process.nextTickï¼ˆnodejsç¯å¢ƒä¸­ï¼‰ MutationObserverï¼š æä¾›äº†ç›‘è§†å¯¹DOMæ ‘æ‰€åšæ›´æ”¹çš„èƒ½åŠ›ï¼ˆhttps://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserverï¼‰ 12345678910111213141516setTimeout(() =&gt; console.log('setTimeout1'), 0);setTimeout(() =&gt; &#123; console.log('setTimeout2'); Promise.resolve().then(() =&gt; &#123; console.log('promise2'); Promise.resolve().then(() =&gt; &#123; console.log('promise3'); &#125;) console.log(5) &#125;) setTimeout(() =&gt; console.log('setTimeout4'), 0);&#125;, 0);setTimeout(() =&gt; console.log('setTimeout3'), 0);Promise.resolve().then(() =&gt; &#123; console.log('promise1');&#125;) é€æ­¥åˆ†æä»£ç æ‰§è¡Œè¿‡ç¨‹:1ã€Run Script2ã€å¼€å§‹è½®è¯¢ï¼š setTimeout1ã€setTimeout2ã€setTimeout3 è¢«æ¨å…¥Task Queueï¼Œpromise1è¢«æ¨å…¥Microtasks Queueã€‚æ­¤æ—¶Task Queueä¸­ï¼š[setTimeout1,setTimeout2,setTimeout3]ï¼ŒMicrotasks Queueä¸­ï¼š[promise1]ã€‚3ã€å¾®ä»»åŠ¡ä¼˜äºå®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œï¼Œæ‰€ä»¥å…ˆæ‰§è¡ŒMicrotasks Queueä¸­çš„é˜Ÿåˆ—promise1ï¼Œæ§åˆ¶å°è¾“å‡ºï¼špromise1ã€‚éšåä¾æ¬¡æ‰§è¡ŒsetTimeout1ã€setTimeout2ã€setTimeout3ï¼Œ4ã€æ‰§è¡Œï¼šsetTimeout1ï¼š è¾“å‡ºsetTimeout1ï¼›æ‰§è¡ŒsetTimeout2: è¾“å‡ºsetTimeout2ï¼Œå‘ç°ä¸€ä¸ªå¾®ä»»åŠ¡promise2,å°†å®ƒåŠ å…¥åˆ°Microtasks Queueï¼Œå‘ç°ä¸€ä¸ªå®ä»»åŠ¡setTimeout4ï¼Œå°†å®ƒåŠ å…¥Taskï¼›æ‰§è¡ŒsetTimeout3ï¼šè¾“å‡º setTimeout3;5ã€æ­¤æ—¶Microtasks Queueä¸­æœ‰[promise2]ï¼Œæ‰§è¡Œpromise2,è¾“å‡ºpromise2ï¼Œè¿™é‡Œåˆæœ‰ä¸ªå¾®ä»»åŠ¡promise3,å°†promise3åŠ å…¥Microtasks Queueï¼Œæ‰§è¡Œconsole.log(5),è¾“å‡º5ã€‚6ã€æ­¤æ—¶Microtasks Queueä¸ä¸ºnullï¼Œè¿˜æœ‰ä»»åŠ¡promise3,æ‰§è¡Œè¾“å‡ºpromise3ã€‚7ã€Microtasks Queueä¸ºnullï¼Œæ£€æŸ¥Task Queueï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªå®ä»»åŠ¡ setTimeout4ï¼Œæ‰§è¡Œå¹¶è¾“å‡ºsetTimeout4ã€‚ å› æ­¤ä»£ç æ‰§è¡Œçš„ç»“æœä¸ºï¼š 12345678promise1setTimeout1setTimeout2setTimeout3promise25promise3setTimeout4 å¾®ä»»åŠ¡æ¯”å®ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œï¼Œå½“å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸ä¸ºnullæ—¶ï¼Œç»§ç»­å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰åˆ°å…¨éƒ¨å¤„ç†å®Œæ¯•ï¼Œåˆ™æ£€æŸ¥å®ä»»åŠ¡é˜Ÿåˆ—å¹¶å¤„ç†é˜Ÿåˆ—çš„ä»»åŠ¡ã€‚ async/awaitasync/await ä¸ promise ä¸€æ ·åŒå±äºå¾®ä»»åŠ¡ã€‚ï¼ˆasyncå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªpromiseï¼‰ 123456789101112131415161718192021async function async1() &#123; console.log(\"async1 start\"); await async2(); console.log(\"async1 end\");&#125;async function async2() &#123; console.log(\"async2\");&#125;console.log(\"script start\");setTimeout(function() &#123; console.log(\"setTimeout\");&#125;, 0);async1();new Promise(function(resolve) &#123; console.log(\"promise1\"); resolve();&#125;).then(function() &#123; console.log(\"promise2\");&#125;);console.log(\"script end\"); ä»¥ä¸Šä»£ç æ‰§è¡Œè¿‡ç¨‹ï¼š1ã€async1()ã€async2ï¼ˆï¼‰å‡½æ•°å®šä¹‰ã€‚2ã€åŒæ­¥ä»»åŠ¡ï¼Œæ§åˆ¶å°è¾“å‡ºï¼šscript startã€‚3ã€setTimeout,åŠ å…¥å®ä»»åŠ¡é˜Ÿåˆ—ã€‚4ã€æ‰§è¡Œå‡½æ•°async1()ã€‚ aï¼šåŒæ­¥ä»»åŠ¡ï¼Œæ§åˆ¶å°è¾“å‡ºasync1 startã€‚ bï¼šawait async2() ï¼Œæ­¤æ—¶çº¿ç¨‹è¢«é˜»å¡ï¼Œæ— æ³•æ‰§è¡Œå½“å‰å‡½æ•°ä¸‹é¢çš„ä»£ç ã€‚ 5ã€async2()ï¼šåŒæ­¥ä»»åŠ¡ï¼Œæ§åˆ¶å°è¾“å‡ºasync2ï¼Œ6ã€ç”±äºasync1()ä¸­ï¼Œawaité˜»å¡é‡Œçº¿ç¨‹ï¼Œæ— æ³•å›åˆ°async1()ï¼Œå› æ­¤ç»§ç»­æ‰§è¡Œasync1()å¤–é¢çš„ä»£ç ã€‚7ã€Promiseï¼Œæ§åˆ¶å°è¾“å‡ºpromise1ï¼Œå°†then()=&gt;{console.log(&quot;promise2&quot;)}å›è°ƒåŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚8ã€åŒæ­¥ä»»åŠ¡,æ§åˆ¶å°è¾“å‡ºscript endï¼Œæ­¤æ—¶ä»£ç æ‰§è¡Œå®Œã€‚9ã€awaité˜»å¡çº¿ç¨‹ç»“æŸã€‚ a:å›åˆ°å‡½æ•°async1()ï¼Œasync2()è¿”å›ä¸€ä¸ªpromise.resolve(undefined).then(undefined)ï¼Œå°†then(undefined)åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚ b:å¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—then()=&gt;{console.log(&quot;promise2&quot;)}ã€then(undefined)ï¼Œæ§åˆ¶å°è¾“å‡ºpromise2ã€‚ c:æ‰§è¡Œconsole.log(&quot;async1 end&quot;)ï¼Œæ§åˆ¶å°è¾“å‡ºasync1 endã€‚ 10ã€å¤„ç†å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ§åˆ¶å°è¾“å‡ºsetTimeoutã€‚ æ‰€ä»¥æ§åˆ¶å°è¾“å‡ºï¼š12345678script startasync1 startasync2promise1script endpromise2async1 endsetTimeout async/awaitæœ¬è´¨ä¸Šè¿˜æ˜¯åŸºäºPromiseçš„ä¸€äº›å°è£…ã€‚æ‰§è¡Œasyncå‡½æ•°å†…é‡åˆ°await fn()æ—¶ï¼Œä¼šé˜»å¡çº¿ç¨‹è·³å‡ºasyncå‡½æ•°ï¼Œç„¶åå†æ¬¡å›åˆ°await fn()å¤„ï¼Œå¦‚æœfn()è¿”å›çš„æ˜¯Promiseå¯¹è±¡è¿˜è¦å†æ¬¡è·³å‡ºasync1()å‡½æ•°ä½“å¤–ç»§ç»­æ‰§è¡Œä»¥å¤–çš„ä»£ç ã€‚ è¡¥å……åœ¨æœ€æ–°çš„Chromeï¼ˆ76.0.3809.87ï¼‰ä¸­æµ‹è¯•ä»¥ä¸Šä»£ç å¾—åˆ°ç»“æœä¸ºï¼š 12345678script startasync1 startasync2promise1script endasync1 endpromise2setTimeout","link":"/2019/04/09/æ‹¾é—JavaScriptâ€”â€”Event-Loop/"}],"tags":[],"categories":[{"name":"Web","slug":"Web","link":"/categories/Web/"},{"name":"Javascript","slug":"Web/Javascript","link":"/categories/Web/Javascript/"},{"name":"Webpack","slug":"Web/Webpack","link":"/categories/Web/Webpack/"},{"name":"Project","slug":"Project","link":"/categories/Project/"}]}